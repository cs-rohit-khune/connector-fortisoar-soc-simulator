{
  "type": "workflow_collections",
  "data": [
    {
      "@type": "WorkflowCollection",
      "name": "Sample - FortiSOAR SOC Simulator - 1.0.6",
      "description": "Sample playbooks for \"FortiSOAR SOC Simulator\" connector. If you are planning to use any of the sample playbooks in your environment, ensure that you clone those playbooks and move them to a different collection, since the sample playbook collection gets deleted during connector upgrade and delete.",
      "visible": true,
      "image": "/api/3/images/b935a872-4109-4e01-93b6-10ac2f81e8fa",
      "uuid": "3554c35e-105c-43b3-8959-ce2981ef745b",
      "id": 21,
      "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
      "createDate": 1624268425,
      "modifyUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
      "modifyDate": 1624268425,
      "recordTags": [],
      "workflows": [
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Run Scenario > Create Alerts",
          "aliasName": null,
          "tag": null,
          "description": null,
          "isActive": true,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "steps",
            "recordIRI",
            "recordID"
          ],
          "synchronous": false,
          "lastModifyDate": 1623778768,
          "collection": "/api/3/workflow_collections/3554c35e-105c-43b3-8959-ce2981ef745b",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/5c6cd32d-b4bb-476c-b845-c49df0af3e09",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Wait For Next Step",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Wait Time < 0",
                    "step_iri": "/api/3/workflow_steps/f7a82373-4f3d-4c97-9813-464825c015cc",
                    "condition": "{{ vars.Wait_Time == -1 }}",
                    "step_name": "Manual Task to Action"
                  },
                  {
                    "option": "Wait Time > 0",
                    "step_iri": "/api/3/workflow_steps/1285d20d-cfd5-4826-a177-e2dadcc9e012",
                    "condition": "{{ vars.Wait_Time > 0 }}",
                    "step_name": "Wait for Alert Creation"
                  },
                  {
                    "option": "create alert",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/6ff8a4e2-41b8-4df4-aa75-96e300ee4917",
                    "step_name": "Create Alert if no wait time"
                  }
                ]
              },
              "status": null,
              "top": "570",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "d22a749d-65dd-4338-8215-ee4414b4a576",
              "id": 1015
            },
            {
              "@type": "WorkflowStep",
              "name": "AlertIRI based on create or Execute ALert",
              "description": null,
              "arguments": {
                "alertIRI": "{{vars.steps.Create_Alert['@id']| ternary(vars.steps.Create_Alert['@id'],vars.alertByExecutePlaybook)}}"
              },
              "status": null,
              "top": "1245",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "8bc73cf4-d4ed-4768-a128-ed8c576fd248",
              "id": 1016
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Alert",
              "description": null,
              "arguments": {
                "when": "{{vars.alert_Steps.type == \"createAlert\"}}",
                "message": {
                  "tags": [],
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "tenant": "",
                  "content": "{% if vars.alert_Steps.postCreateMessage %}\n{{vars.alert_Steps.postCreateMessage}}\n{%endif%}",
                  "records": "{{vars.input.params.recordIRI}}"
                },
                "resource": {
                  "url": "{% if  'url' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.url}}{% else %}None{% endif %}",
                  "name": "{% if  'name' in vars.steps.Replace_String.data.alertFields  %}{{vars.steps.Replace_String.data.alertFields.name}}{% else %}None{% endif %}",
                  "type": "{% if 'type' in vars.steps.Replace_String.data.alertFields%}{{\"AlertType\" | picklist(vars.steps.Replace_String.data.alertFields.type, \"@id\")}}{% else %}None{% endif %}",
                  "state": "{% if  'state' in vars.steps.Replace_String.data.alertFields %}{{\"AlertState\" | picklist(vars.steps.Replace_String.data.alertFields.state, \"@id\")}}{%else%}None{% endif %}",
                  "domain": "{% if  'domain' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.domain}}{% else %}None{% endif %}",
                  "source": "{% if  'source' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.source}}{% else %}None{% endif %}",
                  "status": "{% if  'status' in vars.steps.Replace_String.data.alertFields %}{{\"AlertStatus\" | picklist(vars.steps.Replace_String.data.alertFields.status, \"@id\")}}{% else %}None{% endif %}",
                  "emailTo": "{% if  'emailTo' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.emailTo}}{% else %}None{% endif %}",
                  "metrics": "{% if  'metrics' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.metrics}}{% else %}None{% endif %}",
                  "fileHash": "{% if  'fileHash' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.fileHash}}{% else %}None{% endif %}",
                  "fileName": "{% if  'fileName' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.fileName}}{% else %}None{% endif %}",
                  "filePath": "{% if  'filePath' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.filePath}}{% else %}None{% endif %}",
                  "reporter": "{% if  'reporter' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.reporter}}{% else %}None{% endif %}",
                  "services": "{% if  'services' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.services}}{% else %}None{% endif %}",
                  "severity": "{% if  'severity' in vars.steps.Replace_String.data.alertFields %}{{\"Severity\" | picklist(vars.steps.Replace_String.data.alertFields.severity, \"@id\")}}{% else %}None{% endif %}",
                  "sourceId": "{% if  'sourceId' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.sourceId}}{% else %}None{% endif %}",
                  "sourceIp": "{% if  'sourceIp' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.sourceIp}}{% else %}None{% endif %}",
                  "userName": "{% if  'userName' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.userName}}{% else %}None{% endif %}",
                  "__replace": "",
                  "deviceUID": "{% if  'deviceUID' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.deviceUID}}{% else %}None{% endif %}",
                  "emailBody": "{% if  'emailBody' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.emailBody}}{% else %}None{% endif %}",
                  "epochTime": "{% if  'epochTime' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.epochTime}}{% else %}None{% endif %}",
                  "eventTime": "{% if  'eventTime' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.eventTime}}{% else %}None{% endif %}",
                  "processId": "{% if  'processId' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.processId}}{% else %}None{% endif %}",
                  "bucketName": "{% if  'bucketName' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.bucketName}}{% else %}None{% endif %}",
                  "returnPath": "{% if  'returnPath' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.returnPath}}{% else %}None{% endif %}",
                  "sourcePort": "{% if  'sourcePort' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.sourcePort}}{% else %}None{% endif %}",
                  "sourceTool": "{% if  'sourceTool' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.sourceTool}}{% else %}None{% endif %}",
                  "sourceType": "{% if  'sourceType' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.sourceType}}{% else %}None{% endif %}",
                  "sourcedata": "{% if vars.steps.Replace_String.data.alertFields.sourcedata is mapping %}{{vars.steps.Replace_String.data.alertFields.sourcedata | toJSON }}\n{% elif  'sourcedata' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.sourcedata | toDict | toJSON }}{% else %}None{% endif %}",
                  "commandLine": "{% if  'commandLine' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.commandLine}}{% else %}None{% endif %}",
                  "description": "{% if  'description' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.description}}{% else %}None{% endif %}",
                  "processGuid": "{% if  'processGuid' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.processGuid}}{% else %}None{% endif %}",
                  "processName": "{% if  'processName' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.processName}}{% else %}None{% endif %}",
                  "processTree": "{% if  'processTree' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.processTree}}{% else %}None{% endif %}",
                  "registryKey": "{% if  'registryKey' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.registryKey}}{% else %}None{% endif %}",
                  "targetAsset": "{% if  'targetAsset' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.targetAsset}}{% else %}None{% endif %}",
                  "userDetails": "{% if  'userDetails' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.userDetails}}{% else %}None{% endif %}",
                  "ackSlaStatus": {
                    "id": 289,
                    "@id": "/api/3/picklists/72979f64-e8b9-4888-a965-957e0ec24818",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#808080",
                    "display": "Awaiting Action",
                    "listName": "/api/3/picklist_names/fe36a8f2-fcba-4221-b4ab-1081f596b153",
                    "itemValue": "Awaiting Action",
                    "orderIndex": 2
                  },
                  "closureNotes": "{% if  'closureNotes' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.closureNotes}}{% else %}None{% endif %}",
                  "computerName": "{% if  'computerName' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.computerName}}{% else %}None{% endif %}",
                  "emailHeaders": "{% if  'emailHeaders' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.emailHeaders | toJSON }}{% else %}None{% endif %}",
                  "emailSubject": "{% if  'emailSubject' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.emailSubject}}{% else %}None{% endif %}",
                  "senderDomain": "{% if  'senderDomain' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.senderDomain}}{% else %}None{% endif %}",
                  "destinationIp": "{% if  'destinationIp' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.destinationIp}}{% else %}None{% endif %}",
                  "mitreattackid": "{% if  'mitreattackid' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.mitreattackid}}{% else %}None{% endif %}",
                  "respSlaStatus": {
                    "id": 289,
                    "@id": "/api/3/picklists/72979f64-e8b9-4888-a965-957e0ec24818",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#808080",
                    "display": "Awaiting Action",
                    "listName": "/api/3/picklist_names/fe36a8f2-fcba-4221-b4ab-1081f596b153",
                    "itemValue": "Awaiting Action",
                    "orderIndex": 2
                  },
                  "scheduledTask": "{% if  'scheduledTask' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.scheduledTask}}{% else %}None{% endif %}",
                  "sourceProcess": "{% if  'sourceProcess' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.sourceProcess}}{% else %}None{% endif %}",
                  "targetProcess": "{% if  'targetProcess' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.targetProcess}}{% else %}None{% endif %}",
                  "mitreTechnique": "{% if  'mitreTechnique' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.mitreTechnique}}{% else %}None{% endif %}",
                  "attachmentNames": "{% if  'attachmentNames' in vars.steps.Replace_String.data.alertFields  %}{{vars.steps.Replace_String.data.alertFields.attachmentNames}}{% else %}None{% endif %}",
                  "destinationPort": "{% if  'destinationPort' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.destinationPort}}{% else %}None{% endif %}",
                  "bytesTransferred": "{% if  'bytesTransferred' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.bytesTransferred}}{% else %}None{% endif %}",
                  "escalationReason": "{% if  'escalationReason' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.escalationReason}}{% else %}None{% endif %}",
                  "parentProcessPid": "{% if  'parentProcessPid' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.parentProcessPid}}{% else %}None{% endif %}",
                  "registryKeyValue": "{% if  'registryKeyValue' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.registryKeyValue}}{% else %}None{% endif %}",
                  "parentProcessName": "{% if  'parentProcessName' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.parentProcessName}}{% else %}None{% endif %}",
                  "reporterEmailBody": "{% if  'reporterEmailBody' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.reporterEmailBody}}{% else %}None{% endif %}",
                  "decodedCommandLine": "{% if  'decodedCommandLine' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.decodedCommandLine}}{% else %}None{% endif %}",
                  "senderEmailAddress": "{% if  'senderEmailAddress' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.senderEmailAddress}}{% else %}None{% endif %}",
                  "parentProcessCmdLine": "{% if  'parentProcessCmdLine' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.parentProcessCmdLine}}{% else %}None{% endif %}",
                  "recipientEmailAddress": "{% if  'recipientEmailAddress' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.recipientEmailAddress}}{% else %}None{% endif %}"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "/api/3/alerts",
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "top": "840",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "04a17246-f2c6-4377-ba98-376ce1ba1c6a",
              "id": 1017
            },
            {
              "@type": "WorkflowStep",
              "name": "Replace String",
              "description": null,
              "arguments": {
                "name": "FortiSOAR SOC Simulator",
                "config": "59dbf54a-cb74-48ef-b24a-23fc84f9fdd1",
                "params": {
                  "variables": "{{vars.input.params.steps}}"
                },
                "version": "1.0.0",
                "connector": "fortisoar-soc-simulator",
                "operation": "replace_variables",
                "operationTitle": "Replace Variables",
                "step_variables": []
              },
              "status": null,
              "top": "300",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "3b2dd09b-b1c9-4929-a491-c32014befc03",
              "id": 1018
            },
            {
              "@type": "WorkflowStep",
              "name": "Format ALert List",
              "description": null,
              "arguments": {
                "formatted_alert_list": "{{vars.createdAlertId + [vars.alertIRI]}}"
              },
              "status": null,
              "top": "1380",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "074cf520-16fd-4da8-bb3b-411584c0cbff",
              "id": 1019
            },
            {
              "@type": "WorkflowStep",
              "name": "Launch Step Playbook",
              "description": null,
              "arguments": {
                "when": "{{vars.alert_Steps.type == \"executePlaybook\"}}",
                "arguments": [],
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "{{vars.alert_Steps.playbookIRI}}"
              },
              "status": null,
              "top": "975",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "91113622-06c2-4bde-bd9c-e3a21f62e56c",
              "id": 1020
            },
            {
              "@type": "WorkflowStep",
              "name": "Update created Alerts ID list",
              "description": null,
              "arguments": {
                "resource": {
                  "createdAlertsID": "{{(vars.formatted_alert_list | sum(start=[])| toJSON) if (vars.formatted_alert_list[0] | type_debug == \"list\") else (vars.formatted_alert_list|toJSON|replace(\" \",\"\"))}}"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.input.params.recordIRI}}",
                "collectionType": "/api/3/scenario",
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "top": "1515",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "641d0384-2099-4f55-9897-e11dd3009021",
              "id": 1021
            },
            {
              "@type": "WorkflowStep",
              "name": "Find Created Alerts ID",
              "description": null,
              "arguments": {
                "query": {
                  "sort": [],
                  "limit": 30,
                  "logic": "AND",
                  "filters": [
                    {
                      "type": "primitive",
                      "field": "id",
                      "value": "{{vars.input.params.recordID}}",
                      "operator": "eq",
                      "_operator": "eq"
                    }
                  ],
                  "__selectFields": [
                    "createdAlertsID"
                  ]
                },
                "module": "scenario?$limit=30",
                "checkboxFields": true,
                "step_variables": {
                  "createdAlertId": "{{vars.result[0].createdAlertsID| ternary(vars.result[0].createdAlertsID, [])}}",
                  "alertByExecutePlaybook": "{%if vars.alert_Steps.name in ['LogRhythm Alarms','FDC Alerts'] %}{{vars.steps.Launch_Step_Playbook | json_query('[*].[\"@id\"][]')}}{% elif '@id' in vars.steps.Launch_Step_Playbook %}{{vars.steps.Launch_Step_Playbook[\"@id\"]}} {%else%}{{vars.steps.Launch_Step_Playbook.recordIRI[\"@id\"]}}{%endif%}"
                }
              },
              "status": null,
              "top": "1110",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928770",
              "uuid": "d4864e56-7ff7-4eb7-b170-9398683f339b",
              "id": 1022
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": []
              },
              "status": null,
              "top": "30",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "uuid": "5c6cd32d-b4bb-476c-b845-c49df0af3e09",
              "id": 1023
            },
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "Wait_Time": "{{vars.input.params.steps.waitTimeforNextStep}}",
                "alert_Steps": "{{vars.input.params.steps}}"
              },
              "status": null,
              "top": "160",
              "left": "480",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "e1a3ed65-3d3c-4f72-a93a-4d43fa987e4c",
              "id": 1024
            },
            {
              "@type": "WorkflowStep",
              "name": "Manual Task to Action",
              "description": null,
              "arguments": {
                "type": "DecisionBased",
                "input": {
                  "schema": {
                    "title": "Proceed with Alert Record creation ?",
                    "description": "Click **Proceed** to confirm the Alert Record Creation \n<span style=\"color: #33ACFF;\">Name : {{vars.alert_Steps.name}}</span>\n\n \n",
                    "inputVariables": []
                  }
                },
                "record": "{{vars.input.params.recordIRI}}",
                "resources": "usecase",
                "owner_detail": {
                  "isAssigned": false
                },
                "step_variables": [],
                "response_mapping": {
                  "options": [
                    {
                      "option": "Proceed",
                      "primary": true,
                      "step_iri": "/api/3/workflow_steps/04a17246-f2c6-4377-ba98-376ce1ba1c6a"
                    }
                  ],
                  "duplicateOption": false
                }
              },
              "status": null,
              "top": "705",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/fc04082a-d7dc-4299-96fb-6837b1baa0fe",
              "uuid": "f7a82373-4f3d-4c97-9813-464825c015cc",
              "id": 1025
            },
            {
              "@type": "WorkflowStep",
              "name": "Wait for Alert Creation",
              "description": null,
              "arguments": {
                "delay": {
                  "days": 0,
                  "hours": 0,
                  "weeks": 0,
                  "minutes": "0",
                  "seconds": "{{vars.Wait_Time}}"
                }
              },
              "status": null,
              "top": "705",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/6832e556-b9c7-497a-babe-feda3bd27dbf",
              "uuid": "1285d20d-cfd5-4826-a177-e2dadcc9e012",
              "id": 1026
            },
            {
              "@type": "WorkflowStep",
              "name": "Add comments to Use Case module",
              "description": null,
              "arguments": {
                "message": {
                  "tags": [],
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "tenant": "",
                  "content": "{% if vars.alert_Steps.preCreateMessage %}\n{{vars.alert_Steps.preCreateMessage}}\n{%endif%}\n\n",
                  "records": "{{vars.input.params.recordIRI}}"
                },
                "resource": [],
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.input.params.recordIRI}}",
                "collectionType": "/api/3/scenario",
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "top": "435",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "832a178a-072f-481b-b876-c2ed83f30b37",
              "id": 1027
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Alert if no wait time",
              "description": null,
              "arguments": {
                "params": [],
                "version": "3.0.3",
                "connector": "cyops_utilities",
                "operation": "no_op",
                "operationTitle": "Utils: No Operation",
                "step_variables": []
              },
              "status": null,
              "top": "705",
              "left": "825",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "6ff8a4e2-41b8-4df4-aa75-96e300ee4917",
              "id": 1028
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Create Alert -> Launch Step Playbook",
              "targetStep": "/api/3/workflow_steps/91113622-06c2-4bde-bd9c-e3a21f62e56c",
              "sourceStep": "/api/3/workflow_steps/04a17246-f2c6-4377-ba98-376ce1ba1c6a",
              "label": null,
              "isExecuted": false,
              "uuid": "71a7ee76-ef72-4262-b72e-150f0bd733eb"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Wait step -> a",
              "targetStep": "/api/3/workflow_steps/f7a82373-4f3d-4c97-9813-464825c015cc",
              "sourceStep": "/api/3/workflow_steps/d22a749d-65dd-4338-8215-ee4414b4a576",
              "label": "Wait Time < 0",
              "isExecuted": false,
              "uuid": "e4790416-65cd-414e-82ee-7359ad4d1005"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Replace String -> Add comments to Use Case module",
              "targetStep": "/api/3/workflow_steps/832a178a-072f-481b-b876-c2ed83f30b37",
              "sourceStep": "/api/3/workflow_steps/3b2dd09b-b1c9-4929-a491-c32014befc03",
              "label": null,
              "isExecuted": false,
              "uuid": "57c9b31d-0c98-4a1e-8a01-10869946dfd5"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Launch Step Playbook -> Find Created Alerts ID",
              "targetStep": "/api/3/workflow_steps/d4864e56-7ff7-4eb7-b170-9398683f339b",
              "sourceStep": "/api/3/workflow_steps/91113622-06c2-4bde-bd9c-e3a21f62e56c",
              "label": null,
              "isExecuted": false,
              "uuid": "2254b742-365d-4d0c-ad6f-9dd9fecf8e2a"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Manual Task to Action -> Create Alert",
              "targetStep": "/api/3/workflow_steps/04a17246-f2c6-4377-ba98-376ce1ba1c6a",
              "sourceStep": "/api/3/workflow_steps/f7a82373-4f3d-4c97-9813-464825c015cc",
              "label": "Proceed",
              "isExecuted": false,
              "uuid": "1e8281fc-a3ec-4f84-bac9-56e52c9f9df7"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Replace String",
              "targetStep": "/api/3/workflow_steps/3b2dd09b-b1c9-4929-a491-c32014befc03",
              "sourceStep": "/api/3/workflow_steps/e1a3ed65-3d3c-4f72-a93a-4d43fa987e4c",
              "label": null,
              "isExecuted": false,
              "uuid": "f6ee9b69-17c8-4295-b738-77a08008ae75"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Wait For Next Step -> Create Alert if no wait time",
              "targetStep": "/api/3/workflow_steps/6ff8a4e2-41b8-4df4-aa75-96e300ee4917",
              "sourceStep": "/api/3/workflow_steps/d22a749d-65dd-4338-8215-ee4414b4a576",
              "label": "create alert",
              "isExecuted": false,
              "uuid": "3eeb414a-8bc4-4d79-9d9b-a5bc819f9405"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Add comments to Use Case module -> Wait For Next Step",
              "targetStep": "/api/3/workflow_steps/d22a749d-65dd-4338-8215-ee4414b4a576",
              "sourceStep": "/api/3/workflow_steps/832a178a-072f-481b-b876-c2ed83f30b37",
              "label": null,
              "isExecuted": false,
              "uuid": "92c58370-6906-4141-8ad0-c334f942c609"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Wait for Alert Creation -> Create Alert",
              "targetStep": "/api/3/workflow_steps/04a17246-f2c6-4377-ba98-376ce1ba1c6a",
              "sourceStep": "/api/3/workflow_steps/1285d20d-cfd5-4826-a177-e2dadcc9e012",
              "label": null,
              "isExecuted": false,
              "uuid": "f4bdd4c7-3e1d-4f51-8f56-fb9e6cc430f9"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configuration",
              "targetStep": "/api/3/workflow_steps/e1a3ed65-3d3c-4f72-a93a-4d43fa987e4c",
              "sourceStep": "/api/3/workflow_steps/5c6cd32d-b4bb-476c-b845-c49df0af3e09",
              "label": null,
              "isExecuted": false,
              "uuid": "81859aa6-f7f6-4d24-af35-c87a0a6319db"
            },
            {
              "@type": "WorkflowRoute",
              "name": "alertIRI1 -> Format ALert List",
              "targetStep": "/api/3/workflow_steps/074cf520-16fd-4da8-bb3b-411584c0cbff",
              "sourceStep": "/api/3/workflow_steps/8bc73cf4-d4ed-4768-a128-ed8c576fd248",
              "label": null,
              "isExecuted": false,
              "uuid": "a36b2270-d4f8-44c1-93bb-5278d8738c55"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Wait step -> wait for that much time",
              "targetStep": "/api/3/workflow_steps/1285d20d-cfd5-4826-a177-e2dadcc9e012",
              "sourceStep": "/api/3/workflow_steps/d22a749d-65dd-4338-8215-ee4414b4a576",
              "label": "Wait Time > 0",
              "isExecuted": false,
              "uuid": "f2e04454-5beb-47ac-8ce2-d6be0dd3e995"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Find Created Alerts ID -> alertIRI1",
              "targetStep": "/api/3/workflow_steps/8bc73cf4-d4ed-4768-a128-ed8c576fd248",
              "sourceStep": "/api/3/workflow_steps/d4864e56-7ff7-4eb7-b170-9398683f339b",
              "label": null,
              "isExecuted": false,
              "uuid": "84d60869-29f8-41e9-ba5a-1addc2b0aa55"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create Alert if no wait time -> Create Alert",
              "targetStep": "/api/3/workflow_steps/04a17246-f2c6-4377-ba98-376ce1ba1c6a",
              "sourceStep": "/api/3/workflow_steps/6ff8a4e2-41b8-4df4-aa75-96e300ee4917",
              "label": null,
              "isExecuted": false,
              "uuid": "7089c330-c5d7-4887-91ea-48bea68b31ea"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Format ALert List -> Update created Alerts ID list",
              "targetStep": "/api/3/workflow_steps/641d0384-2099-4f55-9897-e11dd3009021",
              "sourceStep": "/api/3/workflow_steps/074cf520-16fd-4da8-bb3b-411584c0cbff",
              "label": null,
              "isExecuted": false,
              "uuid": "a8532480-9d1c-4824-b6a3-935ff20bd982"
            }
          ],
          "priority": null,
          "uuid": "27b9c187-cc01-48e5-90bf-deea72d558b6",
          "recordTags": [],
          "id": 246,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1624268425,
          "modifyUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "modifyDate": 1624268425,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Run Selected Scenario",
          "aliasName": null,
          "tag": null,
          "description": null,
          "isActive": true,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1623778768,
          "collection": "/api/3/workflow_collections/3554c35e-105c-43b3-8959-ce2981ef745b",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/6ab0e3e8-b1e8-4e32-9142-29d3cbf05384",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Create Scenario",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Get_Scenario_Details[0].steps.Steps}}",
                  "condition": ""
                },
                "arguments": {
                  "steps": "{{vars.item}}",
                  "recordID": "{{vars.steps.Get_Scenario_Details[0].id}}",
                  "recordIRI": "{{vars.steps.Get_Scenario_Details[0]['@id']}}"
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/27b9c187-cc01-48e5-90bf-deea72d558b6"
              },
              "status": null,
              "top": "570",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "683bd694-d9cd-4a3c-ab19-645eeebb7a95",
              "id": 1059
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Scenario Details",
              "description": null,
              "arguments": {
                "query": {
                  "sort": [],
                  "limit": 30,
                  "logic": "AND",
                  "filters": [
                    {
                      "type": "primitive",
                      "field": "title",
                      "value": "{{vars.selectedScenario}}",
                      "operator": "eq",
                      "_operator": "eq"
                    }
                  ],
                  "__selectFields": [
                    "steps",
                    "id",
                    "title"
                  ]
                },
                "module": "scenario?$limit=30",
                "checkboxFields": true,
                "step_variables": []
              },
              "status": null,
              "top": "300",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928770",
              "uuid": "4b9ff56e-f072-4583-86d8-028e0b7cd608",
              "id": 1060
            },
            {
              "@type": "WorkflowStep",
              "name": "Check Pre Req",
              "description": null,
              "arguments": {
                "when": "{{not vars.input.records[0].configDeployed}}",
                "arguments": {
                  "recordIRI": "{{vars.steps.Get_Scenario_Details[0]['@id']}}",
                  "recordName": "{{vars.steps.Get_Scenario_Details[0].title}}"
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bac46748-666a-4374-a780-92539f0efc98"
              },
              "status": null,
              "top": "435",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "1d922488-6c0a-49b6-8c2b-d7986ccf1d98",
              "id": 1061
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "6fab86e0-9f99-43ab-ace6-f87d28ab5c42",
                "title": "Deploy Scenario",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [
                  {
                    "name": "scenario",
                    "type": "scenario",
                    "label": "Scenario",
                    "title": "Lookup (One to Many or One to One)",
                    "usable": true,
                    "tooltip": "",
                    "dataType": "lookup",
                    "formType": "lookup",
                    "required": true,
                    "_expanded": true,
                    "mmdUpdate": true,
                    "collection": false,
                    "dataSource": {
                      "model": "scenario"
                    },
                    "searchable": false,
                    "templateUrl": "app/components/form/fields/typeahead.html",
                    "defaultValue": null,
                    "displayTemplate": "%7B%7B%20title%20%7D%7D",
                    "lengthConstraint": false,
                    "allowedEncryption": false,
                    "allowedGridColumn": true,
                    "useRecordFieldDefault": false
                  }
                ],
                "step_variables": {
                  "input": {
                    "params": {
                      "scenario": "{{vars.request.data[\"scenario\"]}}"
                    },
                    "records": "{{vars.input.records}}"
                  }
                },
                "_promptexpanded": true,
                "displayConditions": {
                  "alerts": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Deploy Scenario",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "6ab0e3e8-b1e8-4e32-9142-29d3cbf05384",
              "id": 1062
            },
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "selectedScenario": "{{vars.input.params.scenario.title}}"
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "ec68df49-53eb-49a2-b7cf-b6770fef5645",
              "id": 1063
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configuration",
              "targetStep": "/api/3/workflow_steps/ec68df49-53eb-49a2-b7cf-b6770fef5645",
              "sourceStep": "/api/3/workflow_steps/6ab0e3e8-b1e8-4e32-9142-29d3cbf05384",
              "label": null,
              "isExecuted": false,
              "uuid": "4d501826-d94d-4a52-aa69-8981c50bb431"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Get Scenario Details",
              "targetStep": "/api/3/workflow_steps/4b9ff56e-f072-4583-86d8-028e0b7cd608",
              "sourceStep": "/api/3/workflow_steps/ec68df49-53eb-49a2-b7cf-b6770fef5645",
              "label": null,
              "isExecuted": false,
              "uuid": "5a7c819d-dfa6-49dc-ad5d-ae96343bd4d0"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Scenario Details -> Check Pre Req",
              "targetStep": "/api/3/workflow_steps/1d922488-6c0a-49b6-8c2b-d7986ccf1d98",
              "sourceStep": "/api/3/workflow_steps/4b9ff56e-f072-4583-86d8-028e0b7cd608",
              "label": null,
              "isExecuted": false,
              "uuid": "f0a4103e-27d2-49fa-955d-590e669a67c7"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Check Pre Req -> Create Scenario",
              "targetStep": "/api/3/workflow_steps/683bd694-d9cd-4a3c-ab19-645eeebb7a95",
              "sourceStep": "/api/3/workflow_steps/1d922488-6c0a-49b6-8c2b-d7986ccf1d98",
              "label": null,
              "isExecuted": false,
              "uuid": "8721940a-9cb2-4083-bd9c-e6f6d684c11e"
            }
          ],
          "priority": null,
          "uuid": "71cf1ad8-9215-49e6-9aa2-be27c3c3ffa6",
          "recordTags": [],
          "id": 255,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1624268425,
          "modifyUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "modifyDate": 1624268425,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Reset Scenario",
          "aliasName": null,
          "tag": null,
          "description": null,
          "isActive": true,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1623778768,
          "collection": "/api/3/workflow_collections/3554c35e-105c-43b3-8959-ce2981ef745b",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/ab3a174e-055e-4a46-bf34-fc48c7acac6d",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Find Comments Associated with Scenario",
              "description": null,
              "arguments": {
                "query": {
                  "sort": [],
                  "limit": 30,
                  "logic": "AND",
                  "filters": [
                    {
                      "type": "primitive",
                      "field": "scenario.id",
                      "value": "{{vars.input.records[0].id}}",
                      "operator": "eq",
                      "_operator": "eq"
                    }
                  ]
                },
                "module": "comments?$limit=30",
                "checkboxFields": false,
                "step_variables": []
              },
              "status": null,
              "top": "30",
              "left": "453",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928770",
              "uuid": "ddeaf7de-2f9f-4f1a-a2e2-11b52b8acfba",
              "id": 1088
            },
            {
              "@type": "WorkflowStep",
              "name": "Delete Alerts",
              "description": null,
              "arguments": {
                "params": {
                  "iri": "{{vars.item}}",
                  "body": "",
                  "method": "DELETE"
                },
                "version": "3.0.3",
                "for_each": {
                  "item": "{{vars.input.records[0].createdAlertsID}}",
                  "condition": ""
                },
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "ignore_errors": true,
                "operationTitle": "FSR: Make FortiSOAR API Call",
                "step_variables": []
              },
              "status": null,
              "top": "29",
              "left": "1100",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "1c09b181-cb13-4edd-8a37-08997612a97f",
              "id": 1089
            },
            {
              "@type": "WorkflowStep",
              "name": "Clear Use Case comments",
              "description": null,
              "arguments": {
                "resource": {
                  "comments": "[]"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.input.records[0]['@id']}}",
                "collectionType": "/api/3/scenario",
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "top": "30",
              "left": "775",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "074f6665-c617-41f9-bcdd-6102ffd545fb",
              "id": 1090
            },
            {
              "@type": "WorkflowStep",
              "name": "Delete Alerts Mentioned in Create Alert ID",
              "description": null,
              "arguments": {
                "params": {
                  "iri": "{{vars.input.records[0]['@id']}}",
                  "body": "{\"createdAlertsID\":null}",
                  "method": "PUT"
                },
                "version": "3.0.2",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "FSR: Make FortiSOAR API Call",
                "step_variables": []
              },
              "status": null,
              "top": "30",
              "left": "1425",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "c1038d19-0bf9-4d67-93f5-a6b40032190a",
              "id": 1091
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "66f79396-8ee2-40bc-8f96-df2db2d57648",
                "resources": [
                  "scenario"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records}}"
                  }
                },
                "displayConditions": {
                  "usecase": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": [
                      {
                        "type": "primitive",
                        "field": "createdAlertsID",
                        "value": "false",
                        "operator": "isnull",
                        "_operator": "isnull"
                      }
                    ]
                  },
                  "scenario": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": true
              },
              "status": null,
              "top": "30",
              "left": "120",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "ab3a174e-055e-4a46-bf34-fc48c7acac6d",
              "id": 1092
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "FIns Comments -> Clear Use Case comments",
              "targetStep": "/api/3/workflow_steps/074f6665-c617-41f9-bcdd-6102ffd545fb",
              "sourceStep": "/api/3/workflow_steps/ddeaf7de-2f9f-4f1a-a2e2-11b52b8acfba",
              "label": null,
              "isExecuted": false,
              "uuid": "400a0b45-95fd-47c6-b9ca-0a9e267dbacb"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Clear Use Case comments -> Delete Alerts",
              "targetStep": "/api/3/workflow_steps/1c09b181-cb13-4edd-8a37-08997612a97f",
              "sourceStep": "/api/3/workflow_steps/074f6665-c617-41f9-bcdd-6102ffd545fb",
              "label": null,
              "isExecuted": false,
              "uuid": "52b532fc-e828-4e43-8f45-3a584022f93b"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> FIns Comments",
              "targetStep": "/api/3/workflow_steps/ddeaf7de-2f9f-4f1a-a2e2-11b52b8acfba",
              "sourceStep": "/api/3/workflow_steps/ab3a174e-055e-4a46-bf34-fc48c7acac6d",
              "label": null,
              "isExecuted": false,
              "uuid": "08af04e7-a34e-488e-b7dc-0752bbc53b01"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Delete Alerts -> Delete Alerts Mentioned in Create Alert ID",
              "targetStep": "/api/3/workflow_steps/c1038d19-0bf9-4d67-93f5-a6b40032190a",
              "sourceStep": "/api/3/workflow_steps/1c09b181-cb13-4edd-8a37-08997612a97f",
              "label": null,
              "isExecuted": false,
              "uuid": "6aac9166-bd8d-4bb9-8031-6a7fcb4df223"
            }
          ],
          "priority": null,
          "uuid": "98506caa-32ab-429d-9c0f-42d92a71b5d1",
          "recordTags": [],
          "id": 260,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1624268425,
          "modifyUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "modifyDate": 1624268425,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Run Scenario",
          "aliasName": null,
          "tag": null,
          "description": null,
          "isActive": true,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1623778768,
          "collection": "/api/3/workflow_collections/3554c35e-105c-43b3-8959-ce2981ef745b",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/fb261ebd-51d4-4118-93f3-226cba0907a9",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Check Pre Req",
              "description": null,
              "arguments": {
                "when": "{{not vars.input.records[0].configDeployed}}",
                "arguments": {
                  "recordIRI": "{{vars.input.records[0]['@id']}}",
                  "recordName": "{{vars.input.records[0].title}}"
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bac46748-666a-4374-a780-92539f0efc98"
              },
              "status": null,
              "top": "300",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "3c3bd288-f083-4eb9-b825-6f8dc6d397d7",
              "id": 1099
            },
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "alert_Steps": "{{vars.input.records[0].steps.Steps}}"
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "9e853093-96c1-437b-8d41-4b6fb8a7abc8",
              "id": 1096
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Alerts",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.alert_Steps}}",
                  "condition": ""
                },
                "arguments": {
                  "steps": "{{vars.item}}",
                  "recordID": "{{vars.input.records[0].id}}",
                  "recordIRI": "{{vars.input.records[0]['@id']}}"
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/27b9c187-cc01-48e5-90bf-deea72d558b6"
              },
              "status": null,
              "top": "435",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "cc804ec1-9e06-4946-935d-734e0a91788d",
              "id": 1097
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "4b9a24e3-ed84-403d-823a-bddf563436c9",
                "resources": [
                  "scenario"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records}}"
                  }
                },
                "displayConditions": {
                  "alerts": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  },
                  "usecase": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  },
                  "scenario": {
                    "sort": [],
                    "limit": 30,
                    "logic": "OR",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": true
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "fb261ebd-51d4-4118-93f3-226cba0907a9",
              "id": 1098
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configuration",
              "targetStep": "/api/3/workflow_steps/9e853093-96c1-437b-8d41-4b6fb8a7abc8",
              "sourceStep": "/api/3/workflow_steps/fb261ebd-51d4-4118-93f3-226cba0907a9",
              "label": null,
              "isExecuted": false,
              "uuid": "67f63869-8a1d-4d7b-9d69-e4ddb7cbd97d"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Check Pre Req",
              "targetStep": "/api/3/workflow_steps/3c3bd288-f083-4eb9-b825-6f8dc6d397d7",
              "sourceStep": "/api/3/workflow_steps/9e853093-96c1-437b-8d41-4b6fb8a7abc8",
              "label": null,
              "isExecuted": false,
              "uuid": "d9a614cd-8a17-4f75-a13f-ad69223f998d"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Check Pre Req -> Create Alerts",
              "targetStep": "/api/3/workflow_steps/cc804ec1-9e06-4946-935d-734e0a91788d",
              "sourceStep": "/api/3/workflow_steps/3c3bd288-f083-4eb9-b825-6f8dc6d397d7",
              "label": null,
              "isExecuted": false,
              "uuid": "ef30e593-1708-4215-b887-2d7aa03138bf"
            }
          ],
          "priority": null,
          "uuid": "a10522ac-2622-40bd-ad79-4487d9a1d7d7",
          "recordTags": [],
          "id": 262,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1624268425,
          "modifyUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "modifyDate": 1624268425,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Pre-req check",
          "aliasName": null,
          "tag": null,
          "description": "Checks if required configurations are set , if not will prompt to set",
          "isActive": true,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "recordIRI",
            "recordName"
          ],
          "synchronous": false,
          "lastModifyDate": 1623844179,
          "collection": "/api/3/workflow_collections/3554c35e-105c-43b3-8959-ce2981ef745b",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/5d9838ea-0404-4357-a74f-4a2ead45dcae",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  }
                }
              },
              "status": null,
              "top": "30",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "uuid": "5d9838ea-0404-4357-a74f-4a2ead45dcae",
              "id": 1106
            },
            {
              "@type": "WorkflowStep",
              "name": "Prompt User",
              "description": null,
              "arguments": {
                "type": "DecisionBased",
                "input": {
                  "schema": {
                    "title": "Did you deploy configuration",
                    "description": "Please confirm if you have deployed configuration required.\n\nIf not , please close this window , navigate to Configuration Manager and import template named -{{vars.input.params.recordName}}. \n\nThen come back here and confirm to proceed.",
                    "inputVariables": []
                  }
                },
                "record": "{{vars.input.params.recordIRI}}",
                "resources": "scenario",
                "owner_detail": {
                  "isAssigned": false
                },
                "step_variables": [],
                "response_mapping": {
                  "options": [
                    {
                      "option": "Yes",
                      "primary": true,
                      "step_iri": "/api/3/workflow_steps/0c3b33da-9d7c-453e-8dc9-9022bfe7abfc"
                    },
                    {
                      "option": "No",
                      "step_iri": "/api/3/workflow_steps/e28647af-e05c-4623-a35e-aefe069a8fde"
                    }
                  ],
                  "duplicateOption": false
                },
                "email_notification": {
                  "enabled": false,
                  "smtpParameters": []
                }
              },
              "status": null,
              "top": "570",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/fc04082a-d7dc-4299-96fb-6837b1baa0fe",
              "uuid": "dc07066e-cedc-44a7-9931-f565c398dbaa",
              "id": 1107
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Record",
              "description": null,
              "arguments": {
                "message": {
                  "tags": [],
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "tenant": "",
                  "content": "Scenario Configuration Deployed",
                  "records": ""
                },
                "resource": [],
                "_showJson": false,
                "operation": "Append",
                "collection": "{{vars.input.params.recordIRI}}",
                "__recommend": [],
                "collectionType": "/api/3/scenario",
                "fieldOperation": {
                  "recordTags": "Append"
                },
                "step_variables": []
              },
              "status": null,
              "top": "705",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "0c3b33da-9d7c-453e-8dc9-9022bfe7abfc",
              "id": 1108
            },
            {
              "@type": "WorkflowStep",
              "name": "Add note",
              "description": null,
              "arguments": {
                "resource": {
                  "type": {
                    "id": 208,
                    "@id": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "icon": null,
                    "uuid": "ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "@type": "Picklist",
                    "color": null,
                    "display": "Comment",
                    "@context": "/api/3/contexts/Picklist",
                    "listName": "/api/3/picklist_names/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                    "itemValue": "Comment",
                    "orderIndex": 1
                  },
                  "people": [],
                  "content": "Configuration Not Deployed",
                  "scenario": "{{vars.input.params.recordIRI}}",
                  "__replace": "",
                  "isImportant": false,
                  "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "/api/3/comments",
                "__recommend": [],
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "top": "705",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "e28647af-e05c-4623-a35e-aefe069a8fde",
              "id": 1109
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Draft Details",
              "description": null,
              "arguments": {
                "draft_job_list": "{{vars.result_data | json_query(\"[*].file\") | json_query(\"[? filename=='\"+vars.input.params.recordName+\"']\")}}"
              },
              "status": null,
              "top": "300",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "f002f4a9-6f91-44eb-986b-3bce44360207",
              "id": 1110
            },
            {
              "@type": "WorkflowStep",
              "name": "Check Import Jobs",
              "description": null,
              "arguments": {
                "params": {
                  "iri": "/api/query/import_jobs",
                  "body": "{\n    \"sort\": [\n        {\n            \"field\": \"modifyDate\",\n            \"direction\": \"DESC\"\n        }\n    ],\n    \"logic\": \"AND\",\n    \"filters\": [],\n    \"__selectFields\": [\n        \"file\",\n        \"status\"\n    ]\n}",
                  "method": "POST"
                },
                "version": "3.1.1",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "FSR: Make FortiSOAR API Call",
                "step_variables": {
                  "result_data": "{{vars.result.data['hydra:member'] | json_query(\"[?status==\\'Draft\\']\")}}"
                }
              },
              "status": null,
              "top": "165",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "7867bd6e-983f-44fb-9951-2e39046ec5c0",
              "id": 1111
            },
            {
              "@type": "WorkflowStep",
              "name": "Is Import needed",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Yes",
                    "step_iri": "/api/3/workflow_steps/dc07066e-cedc-44a7-9931-f565c398dbaa",
                    "condition": "{{ vars.draft_job_list | length != 0 }}",
                    "step_name": "Prompt User"
                  },
                  {
                    "option": "No",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/d3bc9fa8-7c19-4efa-b2c1-dfeb4bc89c34",
                    "step_name": "Do Nothing"
                  }
                ]
              },
              "status": null,
              "top": "440",
              "left": "480",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "c130567b-7b80-4bf2-88d3-744d4036a89f",
              "id": 1112
            },
            {
              "@type": "WorkflowStep",
              "name": "Do Nothing",
              "description": null,
              "arguments": {
                "params": [],
                "version": "3.1.1",
                "connector": "cyops_utilities",
                "operation": "no_op",
                "operationTitle": "Utils: No Operation",
                "step_variables": []
              },
              "status": null,
              "top": "570",
              "left": "650",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "d3bc9fa8-7c19-4efa-b2c1-dfeb4bc89c34",
              "id": 1113
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Check If Configuration is deployed -> Update Record",
              "targetStep": "/api/3/workflow_steps/0c3b33da-9d7c-453e-8dc9-9022bfe7abfc",
              "sourceStep": "/api/3/workflow_steps/dc07066e-cedc-44a7-9931-f565c398dbaa",
              "label": "Yes",
              "isExecuted": false,
              "uuid": "53d03c33-e7a5-40bd-8abe-87eb19c4675a"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Check If Configuration is deployed -> Add note",
              "targetStep": "/api/3/workflow_steps/e28647af-e05c-4623-a35e-aefe069a8fde",
              "sourceStep": "/api/3/workflow_steps/dc07066e-cedc-44a7-9931-f565c398dbaa",
              "label": "No",
              "isExecuted": false,
              "uuid": "ba6fbf6c-eb11-44c0-9cda-eda2a46b09b0"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Check Import Jobs -> Get Draft Details",
              "targetStep": "/api/3/workflow_steps/f002f4a9-6f91-44eb-986b-3bce44360207",
              "sourceStep": "/api/3/workflow_steps/7867bd6e-983f-44fb-9951-2e39046ec5c0",
              "label": null,
              "isExecuted": false,
              "uuid": "63452b0a-cfec-4418-8055-5bd25a05d067"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Check Import Jobs",
              "targetStep": "/api/3/workflow_steps/7867bd6e-983f-44fb-9951-2e39046ec5c0",
              "sourceStep": "/api/3/workflow_steps/5d9838ea-0404-4357-a74f-4a2ead45dcae",
              "label": null,
              "isExecuted": false,
              "uuid": "859f5569-b857-4735-b92d-f4c1e2fe1085"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Draft Details -> Is Import needed",
              "targetStep": "/api/3/workflow_steps/c130567b-7b80-4bf2-88d3-744d4036a89f",
              "sourceStep": "/api/3/workflow_steps/f002f4a9-6f91-44eb-986b-3bce44360207",
              "label": null,
              "isExecuted": false,
              "uuid": "86e32020-68ef-4c8e-9f43-245ee3ba17a2"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is Import needed -> Do Nothing",
              "targetStep": "/api/3/workflow_steps/d3bc9fa8-7c19-4efa-b2c1-dfeb4bc89c34",
              "sourceStep": "/api/3/workflow_steps/c130567b-7b80-4bf2-88d3-744d4036a89f",
              "label": "No",
              "isExecuted": false,
              "uuid": "ff2375c8-09c5-40b8-97d6-d61caeed3173"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is Import needed -> Check If Configuration is deployed",
              "targetStep": "/api/3/workflow_steps/dc07066e-cedc-44a7-9931-f565c398dbaa",
              "sourceStep": "/api/3/workflow_steps/c130567b-7b80-4bf2-88d3-744d4036a89f",
              "label": "Yes",
              "isExecuted": false,
              "uuid": "be7a68d5-68a2-4310-9a88-caa8ee796a4f"
            }
          ],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "bac46748-666a-4374-a780-92539f0efc98",
          "recordTags": [],
          "id": 265,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1624268425,
          "modifyUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "modifyDate": 1624268425,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Export Selected Scenario",
          "aliasName": null,
          "tag": null,
          "description": "Export all selected scenario to a JSON file. This file is created as attachment record",
          "isActive": true,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1624275370,
          "collection": "/api/3/workflow_collections/3554c35e-105c-43b3-8959-ce2981ef745b",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/7366c3f7-d9e1-4ea6-8bd6-ce57c68bee12",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Set recordType",
              "description": null,
              "arguments": {
                "recordType": "{{ vars.input.records[0]['@id'].split('/')[3] }}"
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "27b979ca-44ec-4517-a114-d8ac61ae2b8a",
              "id": 1138
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "1904d049-d489-45b1-b322-89a1deede6ff",
                "title": "Export Scenario",
                "resources": [
                  "scenario"
                ],
                "inputVariables": [
                  {
                    "name": "fileName",
                    "type": "string",
                    "label": "File Name",
                    "tooltip": "",
                    "dataType": "text",
                    "formType": "text",
                    "required": true,
                    "_expanded": true,
                    "defaultValue": "Export",
                    "useRecordFieldDefault": false
                  }
                ],
                "step_variables": {
                  "input": {
                    "params": {
                      "fileName": "{{vars.request.data[\"fileName\"]}}"
                    },
                    "records": "{{vars.input.records}}"
                  }
                },
                "_promptexpanded": true,
                "displayConditions": {
                  "files": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  },
                  "alerts": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  },
                  "assets": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  },
                  "events": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  },
                  "usecase": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  },
                  "scenario": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  },
                  "incidents": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  },
                  "indicators": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "7366c3f7-d9e1-4ea6-8bd6-ce57c68bee12",
              "id": 1137
            },
            {
              "@type": "WorkflowStep",
              "name": "Create file",
              "description": null,
              "arguments": {
                "params": {
                  "contents": "{{ {'records': vars.steps.Export_selected_items.data['hydra:member'], 'type': vars.recordType} | toJSON }}",
                  "filename": "{{vars.input.params.fileName}}.json"
                },
                "version": "2.7.0",
                "connector": "cyops_utilities",
                "operation": "create_file_from_string",
                "operationTitle": "File: Create File from String",
                "step_variables": []
              },
              "status": null,
              "top": "435",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "b8c48bbe-66e9-4619-ad1f-4f71a80df6bc",
              "id": 1136
            },
            {
              "@type": "WorkflowStep",
              "name": "Create attachment from file",
              "description": null,
              "arguments": {
                "params": {
                  "name": "{{vars.steps.Create_file.data.filename}}",
                  "filename": "{{vars.steps.Create_file.data.filename}}",
                  "description": "",
                  "request_headers": "",
                  "multipart_headers": "",
                  "extra_multipart_fields": ""
                },
                "version": "2.3.1",
                "connector": "cyops_utilities",
                "operation": "create_cyops_attachment",
                "operationTitle": "File: Create CyOPs Attachment from File",
                "step_variables": []
              },
              "status": null,
              "top": "570",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "beb0b691-c61b-4073-a8b0-19f623cffc14",
              "id": 1135
            },
            {
              "@type": "WorkflowStep",
              "name": "Export selected items",
              "description": null,
              "arguments": {
                "params": {
                  "iri": "/api/query/{{vars.recordType}}?$export=true&$relationships=true",
                  "body": "{\"filters\": [{\"field\": \"uuid\", \"operator\": \"in\", \"value\": \"{{vars.input.records | json_query('[].\"@id\"') | map('replace', '/api/3/' + vars.recordType + '/', '') | join('|') }}\"}], \"logic\": \"AND\"}",
                  "method": "POST"
                },
                "version": "2.7.0",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "CyOPs: Make CyOPs API Call",
                "step_variables": []
              },
              "status": null,
              "top": "300",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "c1175740-83c4-4392-b95c-abcfb9c0b101",
              "id": 1134
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Export selected items -> Create attachment",
              "targetStep": "/api/3/workflow_steps/b8c48bbe-66e9-4619-ad1f-4f71a80df6bc",
              "sourceStep": "/api/3/workflow_steps/c1175740-83c4-4392-b95c-abcfb9c0b101",
              "label": null,
              "isExecuted": false,
              "uuid": "188553a0-6600-470d-88de-e7a95561f70f"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Set type",
              "targetStep": "/api/3/workflow_steps/27b979ca-44ec-4517-a114-d8ac61ae2b8a",
              "sourceStep": "/api/3/workflow_steps/7366c3f7-d9e1-4ea6-8bd6-ce57c68bee12",
              "label": null,
              "isExecuted": false,
              "uuid": "4807c30c-3638-4513-9a93-3fb27ece369e"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set recordType -> Export selected items",
              "targetStep": "/api/3/workflow_steps/c1175740-83c4-4392-b95c-abcfb9c0b101",
              "sourceStep": "/api/3/workflow_steps/27b979ca-44ec-4517-a114-d8ac61ae2b8a",
              "label": null,
              "isExecuted": false,
              "uuid": "dcce6548-9f36-4c92-add8-97ac757a6404"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create attachment -> Create attachment from file",
              "targetStep": "/api/3/workflow_steps/beb0b691-c61b-4073-a8b0-19f623cffc14",
              "sourceStep": "/api/3/workflow_steps/b8c48bbe-66e9-4619-ad1f-4f71a80df6bc",
              "label": null,
              "isExecuted": false,
              "uuid": "f2b5835f-d75c-4e3b-845a-a90b4ba4283a"
            }
          ],
          "priority": null,
          "uuid": "eb4410bd-97a5-4aed-89a6-06c2bb52a970",
          "recordTags": [
            "ManualTrigger"
          ],
          "id": 271,
          "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "createDate": 1624269804,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1624275370,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Import Scenario",
          "aliasName": null,
          "tag": null,
          "description": "Imports a scenario when a valid JSON file is provided",
          "isActive": true,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1624275385,
          "collection": "/api/3/workflow_collections/3554c35e-105c-43b3-8959-ce2981ef745b",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/6e40c8aa-9976-444e-88e2-25a0fc5d7810",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Import primary fields via Bulk API",
              "description": null,
              "arguments": {
                "when": "{{not vars.input.params.importRelationships}}",
                "params": {
                  "iri": "/api/3/",
                  "body": "{{vars.recordsWithPrimaryFields}}",
                  "method": "POST"
                },
                "version": "2.7.0",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "CyOPs: Make CyOPs API Call",
                "step_variables": []
              },
              "status": null,
              "top": "435",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "05e00264-908b-4ec8-a069-c21c92a76e1d",
              "id": 1142
            },
            {
              "@type": "WorkflowStep",
              "name": "Import relationship fields via Bulk API",
              "description": null,
              "arguments": {
                "when": "{{vars.input.params.importRelationships}}",
                "params": {
                  "iri": "/api/3/update/{{vars.fileData.type }}",
                  "body": "{{ {'data': vars.recordsWithRelationships} }}",
                  "method": "PUT"
                },
                "version": "2.7.0",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "CyOPs: Make CyOPs API Call",
                "step_variables": []
              },
              "status": null,
              "top": "570",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "40877e7d-0884-4fc8-9482-ffdfc1a6ac76",
              "id": 1139
            },
            {
              "@type": "WorkflowStep",
              "name": "Download file",
              "description": null,
              "arguments": {
                "params": {
                  "iri": "{{vars.input.params.jSONFile['@id']}}"
                },
                "version": "2.7.0",
                "connector": "cyops_utilities",
                "operation": "download_file_from_cyops",
                "operationTitle": "File: Compute Hash",
                "step_variables": {
                  "fileData": "{{vars.result.data['cyops_file_path'] | readfile | toJSON | toDict | toDict}}",
                  "fileDataCopy": "{{vars.result.data['cyops_file_path'] | readfile | toJSON | toDict | toDict}}"
                }
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "513ca881-cc8d-4211-887d-a4341755afa9",
              "id": 1140
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "dd63b65e-0d3b-4bc9-ab47-f1025deb0e64",
                "title": "Import Scenario",
                "resources": [
                  "scenario"
                ],
                "inputVariables": [
                  {
                    "name": "jSONFile",
                    "type": "string",
                    "label": "JSON File",
                    "title": "File Field",
                    "usable": true,
                    "tooltip": "Exported JSON file from Export playbook",
                    "dataType": "file",
                    "formType": "file",
                    "required": false,
                    "_expanded": true,
                    "collection": false,
                    "dataSource": {
                      "model": "files"
                    },
                    "searchable": false,
                    "templateUrl": "app/components/form/fields/file.html",
                    "defaultValue": {
                      "filename": null
                    },
                    "allowedEncryption": true,
                    "allowedGridColumn": true,
                    "useRecordFieldDefault": false
                  },
                  {
                    "name": "importRelationships",
                    "type": "boolean",
                    "label": "Import Relationships",
                    "title": "Checkbox",
                    "usable": true,
                    "tooltip": "If checked, will only update the existing records with the relationships",
                    "dataType": "checkbox",
                    "formType": "checkbox",
                    "required": false,
                    "_expanded": true,
                    "collection": false,
                    "searchable": true,
                    "templateUrl": "app/components/form/fields/checkbox.html",
                    "defaultValue": null,
                    "lengthConstraint": false,
                    "allowedEncryption": false,
                    "allowedGridColumn": true,
                    "useRecordFieldDefault": false
                  }
                ],
                "step_variables": {
                  "input": {
                    "params": {
                      "jSONFile": "{{vars.request.data[\"jSONFile\"]}}",
                      "importRelationships": "{{vars.request.data[\"importRelationships\"]}}"
                    },
                    "records": "{{vars.input.records}}"
                  }
                },
                "_promptexpanded": true,
                "displayConditions": {
                  "alerts": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  },
                  "assets": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  },
                  "events": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  },
                  "incidents": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  },
                  "huntalerts": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  },
                  "indicators": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "6e40c8aa-9976-444e-88e2-25a0fc5d7810",
              "id": 1141
            },
            {
              "@type": "WorkflowStep",
              "name": "Split by lists",
              "description": null,
              "arguments": {
                "recordsWithPrimaryFields": "{% set ns = namespace(primaryFields=[]) %}{% for record in vars.fileData.records %}{% for key,value in record.items() %}{% if value is iterable and value is not string and (value['@id'] or (value[0] and value[0]['@id'])) %}{% set _dummy = ns.primaryFields.append(key) %}{% endif %}{% endfor %}{% for field in ns.primaryFields %}{% if field in record %}{% set _dummy = record.pop(field) %}{% endif %}{% endfor %}{% endfor %}{{ vars.fileData.records }}",
                "recordsWithRelationships": "{% set ns = namespace(primaryFields=[]) %}{% for record in vars.fileDataCopy.records %}{% set iri = '/api/3/' + vars.fileDataCopy.type + '/' + record.uuid %}{% for key,value in record.items() %}{% if value is not iterable or value is string or not (value['@id'] or (value[0] and value[0]['@id'])) %}{% set _dummy = ns.primaryFields.append(key) %}{% endif %}{% endfor %}{% for field in ns.primaryFields %}{% if field in record %}{% set _dummy = record.pop(field) %}{% endif %}{% set _dummy = record.update({'@id': iri}) %}{% endfor %}{% endfor %}{{ vars.fileDataCopy.records }}"
              },
              "status": null,
              "top": "300",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "e9e998f4-8c00-47af-bfdd-af9b3d44652a",
              "id": 1143
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Download file",
              "targetStep": "/api/3/workflow_steps/513ca881-cc8d-4211-887d-a4341755afa9",
              "sourceStep": "/api/3/workflow_steps/6e40c8aa-9976-444e-88e2-25a0fc5d7810",
              "label": null,
              "isExecuted": false,
              "uuid": "13e7c73b-984f-4cdd-be25-85199d3d790a"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Download file -> Split by lists",
              "targetStep": "/api/3/workflow_steps/e9e998f4-8c00-47af-bfdd-af9b3d44652a",
              "sourceStep": "/api/3/workflow_steps/513ca881-cc8d-4211-887d-a4341755afa9",
              "label": null,
              "isExecuted": false,
              "uuid": "48cc2ba0-9cd6-463f-a5b3-4c6c464f95f0"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Split by lists -> Import via Bulk API",
              "targetStep": "/api/3/workflow_steps/05e00264-908b-4ec8-a069-c21c92a76e1d",
              "sourceStep": "/api/3/workflow_steps/e9e998f4-8c00-47af-bfdd-af9b3d44652a",
              "label": null,
              "isExecuted": false,
              "uuid": "4e9a7d34-9382-4c74-9520-fc0a15a80bd1"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Import primary fields via Bulk API -> Copy  of Import primary fields via Bulk API",
              "targetStep": "/api/3/workflow_steps/40877e7d-0884-4fc8-9482-ffdfc1a6ac76",
              "sourceStep": "/api/3/workflow_steps/05e00264-908b-4ec8-a069-c21c92a76e1d",
              "label": null,
              "isExecuted": false,
              "uuid": "51c234b4-ed1e-4032-83b7-12647ac390eb"
            }
          ],
          "priority": null,
          "uuid": "f5191470-a923-4c84-a3ce-8208ac585de1",
          "recordTags": [
            "ManualTrigger"
          ],
          "id": 272,
          "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "createDate": 1624269809,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1624275384,
          "owners": [],
          "isPrivate": false
        }
      ]
    }
  ],
  "exported_tags": [
    "ManualTrigger"
  ]
}