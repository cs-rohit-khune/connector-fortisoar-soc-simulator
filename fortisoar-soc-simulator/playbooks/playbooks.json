{
  "type": "workflow_collections",
  "data": [
    {
      "@type": "WorkflowCollection",
      "name": "Sample - FortiSOAR SOC Simulator - 1.0.6",
      "description": "Sample playbooks for \"FortiSOAR SOC Simulator\" connector. If you are planning to use any of the sample playbooks in your environment, ensure that you clone those playbooks and move them to a different collection, since the sample playbook collection gets deleted during connector upgrade and delete.",
      "visible": true,
      "image": "/api/3/images/f8e06717-87cf-4090-abb8-f120beaed37e",
      "uuid": "86c5ea16-d69d-46e1-8013-2437beadbb09",
      "id": 98,
      "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
      "createDate": 1626860823,
      "modifyUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
      "modifyDate": 1626860823,
      "recordTags": [],
      "workflows": [
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Run Scenario > Create Alerts",
          "aliasName": null,
          "tag": null,
          "description": null,
          "isActive": true,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "steps",
            "recordIRI",
            "recordID"
          ],
          "synchronous": false,
          "lastModifyDate": 1625655949,
          "collection": "/api/3/workflow_collections/86c5ea16-d69d-46e1-8013-2437beadbb09",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/973f3b45-5bc1-4522-9e23-0fe88432bd88",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Wait For Next Step",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Wait Time < 0",
                    "step_iri": "/api/3/workflow_steps/f1d05606-cd6f-4564-8cc6-3824b8f8eb1c",
                    "condition": "{{ vars.Wait_Time == -1 }}",
                    "step_name": "Manual Task to Action"
                  },
                  {
                    "option": "Wait Time > 0",
                    "step_iri": "/api/3/workflow_steps/d6724a53-3568-4655-8c3f-92c0c563e076",
                    "condition": "{{ vars.Wait_Time > 0 }}",
                    "step_name": "Wait for Alert Creation"
                  },
                  {
                    "option": "create alert",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/b0c4732c-307d-476d-b54a-d05a9ef63678",
                    "step_name": "Create Alert if no wait time"
                  }
                ]
              },
              "status": null,
              "top": "570",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "e930794a-99ea-420f-a551-5696db6e47f7",
              "id": 5065
            },
            {
              "@type": "WorkflowStep",
              "name": "AlertIRI based on create or Execute ALert",
              "description": null,
              "arguments": {
                "alertIRI": "{{vars.steps.Create_Alert['@id']| ternary(vars.steps.Create_Alert['@id'],vars.alertByExecutePlaybook)}}"
              },
              "status": null,
              "top": "1245",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "d9a1118c-5a92-4f56-9400-9c90f0e33a3e",
              "id": 5066
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Alert",
              "description": null,
              "arguments": {
                "when": "{{vars.alert_Steps.type == \"createAlert\"}}",
                "message": {
                  "tags": [],
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "tenant": "",
                  "content": "{% if vars.alert_Steps.postCreateMessage %}\n{{vars.alert_Steps.postCreateMessage}}\n{%endif%}",
                  "records": "{{vars.input.params.recordIRI}}"
                },
                "resource": {
                  "url": "{% if  'url' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.url}}{% else %}None{% endif %}",
                  "name": "{% if  'name' in vars.steps.Replace_String.data.alertFields  %}{{vars.steps.Replace_String.data.alertFields.name}}{% else %}None{% endif %}",
                  "type": "{% if 'type' in vars.steps.Replace_String.data.alertFields%}{{\"AlertType\" | picklist(vars.steps.Replace_String.data.alertFields.type, \"@id\")}}{% else %}None{% endif %}",
                  "state": "{% if  'state' in vars.steps.Replace_String.data.alertFields %}{{\"AlertState\" | picklist(vars.steps.Replace_String.data.alertFields.state, \"@id\")}}{%else%}None{% endif %}",
                  "domain": "{% if  'domain' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.domain}}{% else %}None{% endif %}",
                  "source": "{% if  'source' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.source}}{% else %}None{% endif %}",
                  "status": "{% if  'status' in vars.steps.Replace_String.data.alertFields %}{{\"AlertStatus\" | picklist(vars.steps.Replace_String.data.alertFields.status, \"@id\")}}{% else %}None{% endif %}",
                  "emailTo": "{% if  'emailTo' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.emailTo}}{% else %}None{% endif %}",
                  "metrics": "{% if  'metrics' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.metrics}}{% else %}None{% endif %}",
                  "fileHash": "{% if  'fileHash' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.fileHash}}{% else %}None{% endif %}",
                  "fileName": "{% if  'fileName' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.fileName}}{% else %}None{% endif %}",
                  "filePath": "{% if  'filePath' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.filePath}}{% else %}None{% endif %}",
                  "reporter": "{% if  'reporter' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.reporter}}{% else %}None{% endif %}",
                  "services": "{% if  'services' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.services}}{% else %}None{% endif %}",
                  "severity": "{% if  'severity' in vars.steps.Replace_String.data.alertFields %}{{\"Severity\" | picklist(vars.steps.Replace_String.data.alertFields.severity, \"@id\")}}{% else %}None{% endif %}",
                  "sourceId": "{% if  'sourceId' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.sourceId}}{% else %}None{% endif %}",
                  "sourceIp": "{% if  'sourceIp' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.sourceIp}}{% else %}None{% endif %}",
                  "userName": "{% if  'userName' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.userName}}{% else %}None{% endif %}",
                  "__replace": "",
                  "deviceUID": "{% if  'deviceUID' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.deviceUID}}{% else %}None{% endif %}",
                  "emailBody": "{% if  'emailBody' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.emailBody}}{% else %}None{% endif %}",
                  "epochTime": "{% if  'epochTime' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.epochTime}}{% else %}None{% endif %}",
                  "eventTime": "{% if  'eventTime' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.eventTime}}{% else %}None{% endif %}",
                  "processId": "{% if  'processId' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.processId}}{% else %}None{% endif %}",
                  "bucketName": "{% if  'bucketName' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.bucketName}}{% else %}None{% endif %}",
                  "returnPath": "{% if  'returnPath' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.returnPath}}{% else %}None{% endif %}",
                  "sourcePort": "{% if  'sourcePort' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.sourcePort}}{% else %}None{% endif %}",
                  "sourceTool": "{% if  'sourceTool' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.sourceTool}}{% else %}None{% endif %}",
                  "sourceType": "{% if  'sourceType' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.sourceType}}{% else %}None{% endif %}",
                  "sourcedata": "{% if vars.steps.Replace_String.data.alertFields.sourcedata is mapping %}{{vars.steps.Replace_String.data.alertFields.sourcedata | toJSON }}\n{% elif  'sourcedata' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.sourcedata | toDict | toJSON }}{% else %}None{% endif %}",
                  "commandLine": "{% if  'commandLine' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.commandLine}}{% else %}None{% endif %}",
                  "description": "{% if  'description' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.description}}{% else %}None{% endif %}",
                  "processGuid": "{% if  'processGuid' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.processGuid}}{% else %}None{% endif %}",
                  "processName": "{% if  'processName' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.processName}}{% else %}None{% endif %}",
                  "processTree": "{% if  'processTree' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.processTree}}{% else %}None{% endif %}",
                  "registryKey": "{% if  'registryKey' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.registryKey}}{% else %}None{% endif %}",
                  "targetAsset": "{% if  'targetAsset' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.targetAsset}}{% else %}None{% endif %}",
                  "userDetails": "{% if  'userDetails' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.userDetails}}{% else %}None{% endif %}",
                  "ackSlaStatus": {
                    "id": 289,
                    "@id": "/api/3/picklists/72979f64-e8b9-4888-a965-957e0ec24818",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#808080",
                    "display": "Awaiting Action",
                    "listName": "/api/3/picklist_names/fe36a8f2-fcba-4221-b4ab-1081f596b153",
                    "itemValue": "Awaiting Action",
                    "orderIndex": 2
                  },
                  "closureNotes": "{% if  'closureNotes' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.closureNotes}}{% else %}None{% endif %}",
                  "computerName": "{% if  'computerName' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.computerName}}{% else %}None{% endif %}",
                  "emailHeaders": "{% if  'emailHeaders' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.emailHeaders | toJSON }}{% else %}None{% endif %}",
                  "emailSubject": "{% if  'emailSubject' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.emailSubject}}{% else %}None{% endif %}",
                  "senderDomain": "{% if  'senderDomain' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.senderDomain}}{% else %}None{% endif %}",
                  "destinationIp": "{% if  'destinationIp' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.destinationIp}}{% else %}None{% endif %}",
                  "mitreattackid": "{% if  'mitreattackid' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.mitreattackid}}{% else %}None{% endif %}",
                  "respSlaStatus": {
                    "id": 289,
                    "@id": "/api/3/picklists/72979f64-e8b9-4888-a965-957e0ec24818",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#808080",
                    "display": "Awaiting Action",
                    "listName": "/api/3/picklist_names/fe36a8f2-fcba-4221-b4ab-1081f596b153",
                    "itemValue": "Awaiting Action",
                    "orderIndex": 2
                  },
                  "scheduledTask": "{% if  'scheduledTask' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.scheduledTask}}{% else %}None{% endif %}",
                  "sourceProcess": "{% if  'sourceProcess' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.sourceProcess}}{% else %}None{% endif %}",
                  "targetProcess": "{% if  'targetProcess' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.targetProcess}}{% else %}None{% endif %}",
                  "mitreTechnique": "{% if  'mitreTechnique' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.mitreTechnique}}{% else %}None{% endif %}",
                  "attachmentNames": "{% if  'attachmentNames' in vars.steps.Replace_String.data.alertFields  %}{{vars.steps.Replace_String.data.alertFields.attachmentNames}}{% else %}None{% endif %}",
                  "destinationPort": "{% if  'destinationPort' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.destinationPort}}{% else %}None{% endif %}",
                  "bytesTransferred": "{% if  'bytesTransferred' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.bytesTransferred}}{% else %}None{% endif %}",
                  "escalationReason": "{% if  'escalationReason' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.escalationReason}}{% else %}None{% endif %}",
                  "parentProcessPid": "{% if  'parentProcessPid' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.parentProcessPid}}{% else %}None{% endif %}",
                  "registryKeyValue": "{% if  'registryKeyValue' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.registryKeyValue}}{% else %}None{% endif %}",
                  "parentProcessName": "{% if  'parentProcessName' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.parentProcessName}}{% else %}None{% endif %}",
                  "reporterEmailBody": "{% if  'reporterEmailBody' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.reporterEmailBody}}{% else %}None{% endif %}",
                  "decodedCommandLine": "{% if  'decodedCommandLine' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.decodedCommandLine}}{% else %}None{% endif %}",
                  "senderEmailAddress": "{% if  'senderEmailAddress' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.senderEmailAddress}}{% else %}None{% endif %}",
                  "parentProcessCmdLine": "{% if  'parentProcessCmdLine' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.parentProcessCmdLine}}{% else %}None{% endif %}",
                  "recipientEmailAddress": "{% if  'recipientEmailAddress' in vars.steps.Replace_String.data.alertFields %}{{vars.steps.Replace_String.data.alertFields.recipientEmailAddress}}{% else %}None{% endif %}"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "/api/3/alerts",
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "top": "840",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "392a85b3-21a8-449c-9516-fb05b1c62ac0",
              "id": 5067
            },
            {
              "@type": "WorkflowStep",
              "name": "Replace String",
              "description": null,
              "arguments": {
                "name": "FortiSOAR SOC Simulator",
                "config": "59dbf54a-cb74-48ef-b24a-23fc84f9fdd1",
                "params": {
                  "variables": "{{vars.input.params.steps}}"
                },
                "version": "1.0.0",
                "connector": "fortisoar-soc-simulator",
                "operation": "replace_variables",
                "operationTitle": "Replace Variables",
                "step_variables": []
              },
              "status": null,
              "top": "300",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "9ad26588-b055-4490-bf0b-bda7100f1abf",
              "id": 5068
            },
            {
              "@type": "WorkflowStep",
              "name": "Format ALert List",
              "description": null,
              "arguments": {
                "formatted_alert_list": "{{vars.createdAlertId + [vars.alertIRI]}}"
              },
              "status": null,
              "top": "1380",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "33879d82-ba52-4860-b18e-87ba352a95c0",
              "id": 5069
            },
            {
              "@type": "WorkflowStep",
              "name": "Launch Step Playbook",
              "description": null,
              "arguments": {
                "when": "{{vars.alert_Steps.type == \"executePlaybook\"}}",
                "arguments": [],
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "{{vars.alert_Steps.playbookIRI}}"
              },
              "status": null,
              "top": "975",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "9fe2e735-c7a9-4716-8bf8-930610721d18",
              "id": 5070
            },
            {
              "@type": "WorkflowStep",
              "name": "Update created Alerts ID list",
              "description": null,
              "arguments": {
                "resource": {
                  "createdAlertsID": "{{(vars.formatted_alert_list | sum(start=[])| toJSON) if (vars.formatted_alert_list[0] | type_debug == \"list\") else (vars.formatted_alert_list|toJSON|replace(\" \",\"\"))}}"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.input.params.recordIRI}}",
                "collectionType": "/api/3/scenario",
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "top": "1515",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "c5a4517c-0da1-4fe3-af43-2a270e443ef2",
              "id": 5071
            },
            {
              "@type": "WorkflowStep",
              "name": "Find Created Alerts ID",
              "description": null,
              "arguments": {
                "query": {
                  "sort": [],
                  "limit": 30,
                  "logic": "AND",
                  "filters": [
                    {
                      "type": "primitive",
                      "field": "id",
                      "value": "{{vars.input.params.recordID}}",
                      "operator": "eq",
                      "_operator": "eq"
                    }
                  ],
                  "__selectFields": [
                    "createdAlertsID"
                  ]
                },
                "module": "scenario?$limit=30",
                "checkboxFields": true,
                "step_variables": {
                  "createdAlertId": "{{vars.result[0].createdAlertsID| ternary(vars.result[0].createdAlertsID, [])}}",
                  "alertByExecutePlaybook": "{%if vars.alert_Steps.name in ['LogRhythm Alarms','FDC Alerts'] %}{{vars.steps.Launch_Step_Playbook | json_query('[*].[\"@id\"][]')}}{% elif '@id' in vars.steps.Launch_Step_Playbook %}{{vars.steps.Launch_Step_Playbook[\"@id\"]}} {%else%}{{vars.steps.Launch_Step_Playbook.recordIRI[\"@id\"]}}{%endif%}"
                }
              },
              "status": null,
              "top": "1110",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928770",
              "uuid": "8a4d5d53-0f00-49a9-bd99-d1444ec02fca",
              "id": 5072
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": []
              },
              "status": null,
              "top": "30",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "uuid": "973f3b45-5bc1-4522-9e23-0fe88432bd88",
              "id": 5073
            },
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "Wait_Time": "{{vars.input.params.steps.waitTimeforNextStep}}",
                "alert_Steps": "{{vars.input.params.steps}}"
              },
              "status": null,
              "top": "160",
              "left": "480",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "07647d63-6c21-475d-883d-7bfa4580f284",
              "id": 5074
            },
            {
              "@type": "WorkflowStep",
              "name": "Manual Task to Action",
              "description": null,
              "arguments": {
                "type": "DecisionBased",
                "input": {
                  "schema": {
                    "title": "Proceed with Alert Record creation ?",
                    "description": "Click **Proceed** to confirm the Alert Record Creation \n<span style=\"color: #33ACFF;\">Name : {{vars.alert_Steps.name}}</span>\n\n \n",
                    "inputVariables": []
                  }
                },
                "record": "{{vars.input.params.recordIRI}}",
                "resources": "usecase",
                "owner_detail": {
                  "isAssigned": false
                },
                "step_variables": [],
                "response_mapping": {
                  "options": [
                    {
                      "option": "Proceed",
                      "primary": true,
                      "step_iri": "/api/3/workflow_steps/392a85b3-21a8-449c-9516-fb05b1c62ac0"
                    }
                  ],
                  "duplicateOption": false
                }
              },
              "status": null,
              "top": "705",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/fc04082a-d7dc-4299-96fb-6837b1baa0fe",
              "uuid": "f1d05606-cd6f-4564-8cc6-3824b8f8eb1c",
              "id": 5075
            },
            {
              "@type": "WorkflowStep",
              "name": "Wait for Alert Creation",
              "description": null,
              "arguments": {
                "delay": {
                  "days": 0,
                  "hours": 0,
                  "weeks": 0,
                  "minutes": "0",
                  "seconds": "{{vars.Wait_Time}}"
                }
              },
              "status": null,
              "top": "705",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/6832e556-b9c7-497a-babe-feda3bd27dbf",
              "uuid": "d6724a53-3568-4655-8c3f-92c0c563e076",
              "id": 5076
            },
            {
              "@type": "WorkflowStep",
              "name": "Add comments to Use Case module",
              "description": null,
              "arguments": {
                "message": {
                  "tags": [],
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "tenant": "",
                  "content": "{% if vars.alert_Steps.preCreateMessage %}\n{{vars.alert_Steps.preCreateMessage}}\n{%endif%}\n\n",
                  "records": "{{vars.input.params.recordIRI}}"
                },
                "resource": [],
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.input.params.recordIRI}}",
                "collectionType": "/api/3/scenario",
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "top": "435",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "344806ac-fa54-46a7-8d59-acada5ed82d9",
              "id": 5077
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Alert if no wait time",
              "description": null,
              "arguments": {
                "params": [],
                "version": "3.0.3",
                "connector": "cyops_utilities",
                "operation": "no_op",
                "operationTitle": "Utils: No Operation",
                "step_variables": []
              },
              "status": null,
              "top": "705",
              "left": "825",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "b0c4732c-307d-476d-b54a-d05a9ef63678",
              "id": 5078
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Create Alert -> Launch Step Playbook",
              "targetStep": "/api/3/workflow_steps/9fe2e735-c7a9-4716-8bf8-930610721d18",
              "sourceStep": "/api/3/workflow_steps/392a85b3-21a8-449c-9516-fb05b1c62ac0",
              "label": null,
              "isExecuted": false,
              "uuid": "0f8bf0aa-8288-4393-b547-2e8356bb85bb"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Wait step -> a",
              "targetStep": "/api/3/workflow_steps/f1d05606-cd6f-4564-8cc6-3824b8f8eb1c",
              "sourceStep": "/api/3/workflow_steps/e930794a-99ea-420f-a551-5696db6e47f7",
              "label": "Wait Time < 0",
              "isExecuted": false,
              "uuid": "e0e54fc8-9cfa-403d-a203-97043d4714a6"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Replace String -> Add comments to Use Case module",
              "targetStep": "/api/3/workflow_steps/344806ac-fa54-46a7-8d59-acada5ed82d9",
              "sourceStep": "/api/3/workflow_steps/9ad26588-b055-4490-bf0b-bda7100f1abf",
              "label": null,
              "isExecuted": false,
              "uuid": "c074f2c2-cde3-4b82-b598-f37b4b2bc15f"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Launch Step Playbook -> Find Created Alerts ID",
              "targetStep": "/api/3/workflow_steps/8a4d5d53-0f00-49a9-bd99-d1444ec02fca",
              "sourceStep": "/api/3/workflow_steps/9fe2e735-c7a9-4716-8bf8-930610721d18",
              "label": null,
              "isExecuted": false,
              "uuid": "5e4a770b-bff7-468b-a006-85b0450bc598"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Manual Task to Action -> Create Alert",
              "targetStep": "/api/3/workflow_steps/392a85b3-21a8-449c-9516-fb05b1c62ac0",
              "sourceStep": "/api/3/workflow_steps/f1d05606-cd6f-4564-8cc6-3824b8f8eb1c",
              "label": "Proceed",
              "isExecuted": false,
              "uuid": "f06c2e50-1a69-4a45-84cf-3bb7d4dec298"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Replace String",
              "targetStep": "/api/3/workflow_steps/9ad26588-b055-4490-bf0b-bda7100f1abf",
              "sourceStep": "/api/3/workflow_steps/07647d63-6c21-475d-883d-7bfa4580f284",
              "label": null,
              "isExecuted": false,
              "uuid": "d80ebf43-82fd-461a-8262-b6188ff22c45"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Wait For Next Step -> Create Alert if no wait time",
              "targetStep": "/api/3/workflow_steps/b0c4732c-307d-476d-b54a-d05a9ef63678",
              "sourceStep": "/api/3/workflow_steps/e930794a-99ea-420f-a551-5696db6e47f7",
              "label": "create alert",
              "isExecuted": false,
              "uuid": "1e0502d2-7a67-482a-bea8-77a773c5ac34"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Add comments to Use Case module -> Wait For Next Step",
              "targetStep": "/api/3/workflow_steps/e930794a-99ea-420f-a551-5696db6e47f7",
              "sourceStep": "/api/3/workflow_steps/344806ac-fa54-46a7-8d59-acada5ed82d9",
              "label": null,
              "isExecuted": false,
              "uuid": "0f8d0814-4226-4301-9c32-b61b6960e72e"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Wait for Alert Creation -> Create Alert",
              "targetStep": "/api/3/workflow_steps/392a85b3-21a8-449c-9516-fb05b1c62ac0",
              "sourceStep": "/api/3/workflow_steps/d6724a53-3568-4655-8c3f-92c0c563e076",
              "label": null,
              "isExecuted": false,
              "uuid": "d3bb1fdf-8e03-4936-bcd2-bbf7e0ea8367"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configuration",
              "targetStep": "/api/3/workflow_steps/07647d63-6c21-475d-883d-7bfa4580f284",
              "sourceStep": "/api/3/workflow_steps/973f3b45-5bc1-4522-9e23-0fe88432bd88",
              "label": null,
              "isExecuted": false,
              "uuid": "e3f975ce-64af-4a1b-862e-cbd6148d5e47"
            },
            {
              "@type": "WorkflowRoute",
              "name": "alertIRI1 -> Format ALert List",
              "targetStep": "/api/3/workflow_steps/33879d82-ba52-4860-b18e-87ba352a95c0",
              "sourceStep": "/api/3/workflow_steps/d9a1118c-5a92-4f56-9400-9c90f0e33a3e",
              "label": null,
              "isExecuted": false,
              "uuid": "a930f5c4-403d-4423-b8b3-0c7bb036b500"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Wait step -> wait for that much time",
              "targetStep": "/api/3/workflow_steps/d6724a53-3568-4655-8c3f-92c0c563e076",
              "sourceStep": "/api/3/workflow_steps/e930794a-99ea-420f-a551-5696db6e47f7",
              "label": "Wait Time > 0",
              "isExecuted": false,
              "uuid": "6d12b74c-3aad-4dd1-8fbe-18d5b713cfd8"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Find Created Alerts ID -> alertIRI1",
              "targetStep": "/api/3/workflow_steps/d9a1118c-5a92-4f56-9400-9c90f0e33a3e",
              "sourceStep": "/api/3/workflow_steps/8a4d5d53-0f00-49a9-bd99-d1444ec02fca",
              "label": null,
              "isExecuted": false,
              "uuid": "c6393dee-2549-4ba5-8018-ae2b86150a4d"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create Alert if no wait time -> Create Alert",
              "targetStep": "/api/3/workflow_steps/392a85b3-21a8-449c-9516-fb05b1c62ac0",
              "sourceStep": "/api/3/workflow_steps/b0c4732c-307d-476d-b54a-d05a9ef63678",
              "label": null,
              "isExecuted": false,
              "uuid": "cff3ba8e-1afc-43ce-8f85-d0e8fce73cd8"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Format ALert List -> Update created Alerts ID list",
              "targetStep": "/api/3/workflow_steps/c5a4517c-0da1-4fe3-af43-2a270e443ef2",
              "sourceStep": "/api/3/workflow_steps/33879d82-ba52-4860-b18e-87ba352a95c0",
              "label": null,
              "isExecuted": false,
              "uuid": "4cfa8416-c012-44ae-ace9-5b6e290b2d55"
            }
          ],
          "priority": null,
          "uuid": "27b9c187-cc01-48e5-90bf-deea72d558b6",
          "recordTags": [],
          "id": 1178,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1626860823,
          "modifyUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "modifyDate": 1626860823,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Run Selected Scenario",
          "aliasName": null,
          "tag": null,
          "description": null,
          "isActive": true,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1626867810,
          "collection": "/api/3/workflow_collections/86c5ea16-d69d-46e1-8013-2437beadbb09",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/82ca2fd5-bb31-4db8-ba9c-9930eeaa5dff",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Create Scenario",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Get_Scenario_Details[0].steps.Steps}}",
                  "condition": ""
                },
                "arguments": {
                  "steps": "{{vars.item}}",
                  "recordID": "{{vars.steps.Get_Scenario_Details[0].id}}",
                  "recordIRI": "{{vars.steps.Get_Scenario_Details[0]['@id']}}"
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/27b9c187-cc01-48e5-90bf-deea72d558b6"
              },
              "status": null,
              "top": "570",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "2c9928ad-8400-42ba-b4d0-1f2dcb5e40f1",
              "id": 5079
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Scenario Details",
              "description": null,
              "arguments": {
                "query": {
                  "sort": [],
                  "limit": 30,
                  "logic": "AND",
                  "filters": [
                    {
                      "type": "primitive",
                      "field": "title",
                      "value": "{{vars.selectedScenario}}",
                      "operator": "eq",
                      "_operator": "eq"
                    }
                  ],
                  "__selectFields": [
                    "title",
                    "steps",
                    "id",
                    "configuration"
                  ]
                },
                "module": "scenario?$limit=30",
                "checkboxFields": true,
                "step_variables": []
              },
              "status": null,
              "top": "300",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928770",
              "uuid": "6f0657e4-2712-4706-a464-38f089d20bb2",
              "id": 5080
            },
            {
              "@type": "WorkflowStep",
              "name": "Check Pre Req",
              "description": null,
              "arguments": {
                "when": "{{not vars.input.records[0].configDeployed}}",
                "arguments": {
                  "recordIRI": "{{vars.steps.Get_Scenario_Details[0]['@id']}}",
                  "recordName": "{{vars.steps.Get_Scenario_Details[0].configuration}}"
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bac46748-666a-4374-a780-92539f0efc98"
              },
              "status": null,
              "top": "435",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "4615ace1-c9f8-4b37-a119-a82746ff3eb3",
              "id": 5081
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "06541acc-eef5-41c4-8abf-ac8db5739e92",
                "title": "Deploy Scenario",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [
                  {
                    "name": "scenario",
                    "type": "scenario",
                    "label": "Scenario",
                    "title": "Lookup (One to Many or One to One)",
                    "usable": true,
                    "tooltip": "",
                    "dataType": "lookup",
                    "formType": "lookup",
                    "required": true,
                    "_expanded": true,
                    "mmdUpdate": true,
                    "collection": false,
                    "dataSource": {
                      "model": "scenario"
                    },
                    "searchable": false,
                    "templateUrl": "app/components/form/fields/typeahead.html",
                    "defaultValue": null,
                    "displayTemplate": "%7B%7B%20title%20%7D%7D",
                    "lengthConstraint": false,
                    "allowedEncryption": false,
                    "allowedGridColumn": true,
                    "useRecordFieldDefault": false
                  }
                ],
                "step_variables": {
                  "input": {
                    "params": {
                      "scenario": "{{vars.request.data[\"scenario\"]}}"
                    },
                    "records": "{{vars.input.records}}"
                  }
                },
                "_promptexpanded": true,
                "displayConditions": {
                  "alerts": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Deploy Scenario",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "82ca2fd5-bb31-4db8-ba9c-9930eeaa5dff",
              "id": 5082
            },
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "selectedScenario": "{{vars.input.params.scenario.title}}"
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "3d8aab01-b491-4f49-a057-33d8cfe26ef9",
              "id": 5083
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configuration",
              "targetStep": "/api/3/workflow_steps/3d8aab01-b491-4f49-a057-33d8cfe26ef9",
              "sourceStep": "/api/3/workflow_steps/82ca2fd5-bb31-4db8-ba9c-9930eeaa5dff",
              "label": null,
              "isExecuted": false,
              "uuid": "7da5769e-0c8d-49e1-a4b2-7b6d0541690e"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Get Scenario Details",
              "targetStep": "/api/3/workflow_steps/6f0657e4-2712-4706-a464-38f089d20bb2",
              "sourceStep": "/api/3/workflow_steps/3d8aab01-b491-4f49-a057-33d8cfe26ef9",
              "label": null,
              "isExecuted": false,
              "uuid": "e49dd191-86c1-4c5c-a64b-dc1e3a90a15f"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Scenario Details -> Check Pre Req",
              "targetStep": "/api/3/workflow_steps/4615ace1-c9f8-4b37-a119-a82746ff3eb3",
              "sourceStep": "/api/3/workflow_steps/6f0657e4-2712-4706-a464-38f089d20bb2",
              "label": null,
              "isExecuted": false,
              "uuid": "060e1842-6d23-40aa-809e-d1c827404b76"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Check Pre Req -> Create Scenario",
              "targetStep": "/api/3/workflow_steps/2c9928ad-8400-42ba-b4d0-1f2dcb5e40f1",
              "sourceStep": "/api/3/workflow_steps/4615ace1-c9f8-4b37-a119-a82746ff3eb3",
              "label": null,
              "isExecuted": false,
              "uuid": "71ecd887-c0c4-4291-a3fc-eb64bf4f1a62"
            }
          ],
          "priority": null,
          "uuid": "71cf1ad8-9215-49e6-9aa2-be27c3c3ffa6",
          "recordTags": [],
          "id": 1179,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1626860823,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1626867810,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Reset Scenario",
          "aliasName": null,
          "tag": null,
          "description": null,
          "isActive": true,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1625655949,
          "collection": "/api/3/workflow_collections/86c5ea16-d69d-46e1-8013-2437beadbb09",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/4f2204cb-7ab0-44d5-ba6f-cee39abddafb",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Find Comments Associated with Scenario",
              "description": null,
              "arguments": {
                "query": {
                  "sort": [],
                  "limit": 30,
                  "logic": "AND",
                  "filters": [
                    {
                      "type": "primitive",
                      "field": "scenario.id",
                      "value": "{{vars.input.records[0].id}}",
                      "operator": "eq",
                      "_operator": "eq"
                    }
                  ]
                },
                "module": "comments?$limit=30",
                "checkboxFields": false,
                "step_variables": []
              },
              "status": null,
              "top": "30",
              "left": "453",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928770",
              "uuid": "3b68c4b7-e9b3-4021-bae0-5c8b1c650c24",
              "id": 5084
            },
            {
              "@type": "WorkflowStep",
              "name": "Delete Alerts",
              "description": null,
              "arguments": {
                "params": {
                  "iri": "{{vars.item}}",
                  "body": "",
                  "method": "DELETE"
                },
                "version": "3.0.3",
                "for_each": {
                  "item": "{{vars.input.records[0].createdAlertsID}}",
                  "condition": ""
                },
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "ignore_errors": true,
                "operationTitle": "FSR: Make FortiSOAR API Call",
                "step_variables": []
              },
              "status": null,
              "top": "29",
              "left": "1100",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "ddaca4c1-77ba-4dd9-9eb7-929737c763d2",
              "id": 5085
            },
            {
              "@type": "WorkflowStep",
              "name": "Clear Use Case comments",
              "description": null,
              "arguments": {
                "resource": {
                  "comments": "[]"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.input.records[0]['@id']}}",
                "collectionType": "/api/3/scenario",
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "top": "30",
              "left": "775",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "0e90a642-c833-4e74-817b-d9b728a201d7",
              "id": 5086
            },
            {
              "@type": "WorkflowStep",
              "name": "Delete Alerts Mentioned in Create Alert ID",
              "description": null,
              "arguments": {
                "params": {
                  "iri": "{{vars.input.records[0]['@id']}}",
                  "body": "{\"createdAlertsID\":null}",
                  "method": "PUT"
                },
                "version": "3.0.2",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "FSR: Make FortiSOAR API Call",
                "step_variables": []
              },
              "status": null,
              "top": "30",
              "left": "1425",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "20c928f0-cd62-4c41-a140-d1c04541dc23",
              "id": 5087
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "0bd7509e-8eef-4ba2-b64c-1307fb90a2d8",
                "resources": [
                  "scenario"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records}}"
                  }
                },
                "displayConditions": {
                  "usecase": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": [
                      {
                        "type": "primitive",
                        "field": "createdAlertsID",
                        "value": "false",
                        "operator": "isnull",
                        "_operator": "isnull"
                      }
                    ]
                  },
                  "scenario": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": true
              },
              "status": null,
              "top": "30",
              "left": "120",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "4f2204cb-7ab0-44d5-ba6f-cee39abddafb",
              "id": 5088
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "FIns Comments -> Clear Use Case comments",
              "targetStep": "/api/3/workflow_steps/0e90a642-c833-4e74-817b-d9b728a201d7",
              "sourceStep": "/api/3/workflow_steps/3b68c4b7-e9b3-4021-bae0-5c8b1c650c24",
              "label": null,
              "isExecuted": false,
              "uuid": "c6b2c4bc-39ee-4679-9f12-8395684bb658"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Clear Use Case comments -> Delete Alerts",
              "targetStep": "/api/3/workflow_steps/ddaca4c1-77ba-4dd9-9eb7-929737c763d2",
              "sourceStep": "/api/3/workflow_steps/0e90a642-c833-4e74-817b-d9b728a201d7",
              "label": null,
              "isExecuted": false,
              "uuid": "098a2ec8-802b-4c50-b35a-13c26fc2c1a5"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> FIns Comments",
              "targetStep": "/api/3/workflow_steps/3b68c4b7-e9b3-4021-bae0-5c8b1c650c24",
              "sourceStep": "/api/3/workflow_steps/4f2204cb-7ab0-44d5-ba6f-cee39abddafb",
              "label": null,
              "isExecuted": false,
              "uuid": "f7d87b1c-61e4-4d89-9752-11d94cc82b76"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Delete Alerts -> Delete Alerts Mentioned in Create Alert ID",
              "targetStep": "/api/3/workflow_steps/20c928f0-cd62-4c41-a140-d1c04541dc23",
              "sourceStep": "/api/3/workflow_steps/ddaca4c1-77ba-4dd9-9eb7-929737c763d2",
              "label": null,
              "isExecuted": false,
              "uuid": "53533a05-0a84-4476-b7fd-ad886be2c0c8"
            }
          ],
          "priority": null,
          "uuid": "98506caa-32ab-429d-9c0f-42d92a71b5d1",
          "recordTags": [],
          "id": 1180,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1626860823,
          "modifyUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "modifyDate": 1626860823,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Run Scenario",
          "aliasName": null,
          "tag": null,
          "description": null,
          "isActive": true,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1625655949,
          "collection": "/api/3/workflow_collections/86c5ea16-d69d-46e1-8013-2437beadbb09",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/6296aabe-9fc3-48ff-b077-6199bd340339",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Check Pre Req",
              "description": null,
              "arguments": {
                "when": "{{vars.input.records[0].configuration}}",
                "arguments": {
                  "recordIRI": "{{vars.input.records[0]['@id']}}",
                  "recordName": "{{vars.input.records[0].configuration}}"
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bac46748-666a-4374-a780-92539f0efc98"
              },
              "status": null,
              "top": "300",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "c77368a4-73f7-47d6-a5ec-9441ebe28be2",
              "id": 5089
            },
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "alert_Steps": "{{vars.input.records[0].steps.Steps}}"
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "2c8eb9b5-4b09-44f1-ab7d-c9b2a1301713",
              "id": 5090
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Alerts",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.alert_Steps}}",
                  "condition": ""
                },
                "arguments": {
                  "steps": "{{vars.item}}",
                  "recordID": "{{vars.input.records[0].id}}",
                  "recordIRI": "{{vars.input.records[0]['@id']}}"
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/27b9c187-cc01-48e5-90bf-deea72d558b6"
              },
              "status": null,
              "top": "435",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "32ef4b38-2fec-4933-abcc-f51e77938491",
              "id": 5091
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "7f0834e0-f79e-49a2-aa19-2ef7ce9aac32",
                "resources": [
                  "scenario"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records}}"
                  }
                },
                "displayConditions": {
                  "alerts": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  },
                  "usecase": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  },
                  "scenario": {
                    "sort": [],
                    "limit": 30,
                    "logic": "OR",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": true
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "6296aabe-9fc3-48ff-b077-6199bd340339",
              "id": 5092
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configuration",
              "targetStep": "/api/3/workflow_steps/2c8eb9b5-4b09-44f1-ab7d-c9b2a1301713",
              "sourceStep": "/api/3/workflow_steps/6296aabe-9fc3-48ff-b077-6199bd340339",
              "label": null,
              "isExecuted": false,
              "uuid": "ddb16d2b-aac8-454c-b934-b85b3cccb799"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Check Pre Req",
              "targetStep": "/api/3/workflow_steps/c77368a4-73f7-47d6-a5ec-9441ebe28be2",
              "sourceStep": "/api/3/workflow_steps/2c8eb9b5-4b09-44f1-ab7d-c9b2a1301713",
              "label": null,
              "isExecuted": false,
              "uuid": "0217ad10-63c7-4d38-bb3e-69166579729c"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Check Pre Req -> Create Alerts",
              "targetStep": "/api/3/workflow_steps/32ef4b38-2fec-4933-abcc-f51e77938491",
              "sourceStep": "/api/3/workflow_steps/c77368a4-73f7-47d6-a5ec-9441ebe28be2",
              "label": null,
              "isExecuted": false,
              "uuid": "d8ac8ce6-33ba-4a63-9ef1-8e0a706f22d1"
            }
          ],
          "priority": null,
          "uuid": "a10522ac-2622-40bd-ad79-4487d9a1d7d7",
          "recordTags": [],
          "id": 1181,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1626860823,
          "modifyUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "modifyDate": 1626860823,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Import Scenario",
          "aliasName": null,
          "tag": null,
          "description": "Imports a scenario when a valid JSON file is provided",
          "isActive": true,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1625655949,
          "collection": "/api/3/workflow_collections/86c5ea16-d69d-46e1-8013-2437beadbb09",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/5d22caeb-2354-4b93-bf8b-e3d8694fc1fe",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Import primary fields via Bulk API",
              "description": null,
              "arguments": {
                "when": "{{not vars.input.params.importRelationships}}",
                "params": {
                  "iri": "/api/3/",
                  "body": "{{vars.recordsWithPrimaryFields}}",
                  "method": "POST"
                },
                "version": "2.7.0",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "CyOPs: Make CyOPs API Call",
                "step_variables": []
              },
              "status": null,
              "top": "435",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "f8559c3d-2db0-49ae-8af1-a93665020aaa",
              "id": 5093
            },
            {
              "@type": "WorkflowStep",
              "name": "Import relationship fields via Bulk API",
              "description": null,
              "arguments": {
                "when": "{{vars.input.params.importRelationships}}",
                "params": {
                  "iri": "/api/3/update/{{vars.fileData.type }}",
                  "body": "{{ {'data': vars.recordsWithRelationships} }}",
                  "method": "PUT"
                },
                "version": "2.7.0",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "CyOPs: Make CyOPs API Call",
                "step_variables": []
              },
              "status": null,
              "top": "570",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "24bac88e-b1b5-4dfd-9098-c13be14c1db7",
              "id": 5094
            },
            {
              "@type": "WorkflowStep",
              "name": "Download file",
              "description": null,
              "arguments": {
                "params": {
                  "iri": "{{vars.input.params.jSONFile['@id']}}"
                },
                "version": "2.7.0",
                "connector": "cyops_utilities",
                "operation": "download_file_from_cyops",
                "operationTitle": "File: Compute Hash",
                "step_variables": {
                  "fileData": "{{vars.result.data['cyops_file_path'] | readfile | toJSON | toDict | toDict}}",
                  "fileDataCopy": "{{vars.result.data['cyops_file_path'] | readfile | toJSON | toDict | toDict}}"
                }
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "d5dbfb67-afd8-4988-8456-9fad98de0d69",
              "id": 5095
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "670b0692-c78b-4b8f-aa5e-25080cf7d03c",
                "title": "Import Scenario",
                "resources": [
                  "scenario"
                ],
                "inputVariables": [
                  {
                    "name": "jSONFile",
                    "type": "string",
                    "label": "JSON File",
                    "title": "File Field",
                    "usable": true,
                    "tooltip": "Exported JSON file from Export playbook",
                    "dataType": "file",
                    "formType": "file",
                    "required": false,
                    "_expanded": true,
                    "collection": false,
                    "dataSource": {
                      "model": "files"
                    },
                    "searchable": false,
                    "templateUrl": "app/components/form/fields/file.html",
                    "defaultValue": {
                      "filename": null
                    },
                    "allowedEncryption": true,
                    "allowedGridColumn": true,
                    "useRecordFieldDefault": false
                  },
                  {
                    "name": "importRelationships",
                    "type": "boolean",
                    "label": "Import Relationships",
                    "title": "Checkbox",
                    "usable": true,
                    "tooltip": "If checked, will only update the existing records with the relationships",
                    "dataType": "checkbox",
                    "formType": "checkbox",
                    "required": false,
                    "_expanded": true,
                    "collection": false,
                    "searchable": true,
                    "templateUrl": "app/components/form/fields/checkbox.html",
                    "defaultValue": null,
                    "lengthConstraint": false,
                    "allowedEncryption": false,
                    "allowedGridColumn": true,
                    "useRecordFieldDefault": false
                  }
                ],
                "step_variables": {
                  "input": {
                    "params": {
                      "jSONFile": "{{vars.request.data[\"jSONFile\"]}}",
                      "importRelationships": "{{vars.request.data[\"importRelationships\"]}}"
                    },
                    "records": "{{vars.input.records}}"
                  }
                },
                "_promptexpanded": true,
                "displayConditions": {
                  "alerts": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  },
                  "assets": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  },
                  "events": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  },
                  "incidents": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  },
                  "huntalerts": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  },
                  "indicators": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "5d22caeb-2354-4b93-bf8b-e3d8694fc1fe",
              "id": 5096
            },
            {
              "@type": "WorkflowStep",
              "name": "Split by lists",
              "description": null,
              "arguments": {
                "recordsWithPrimaryFields": "{% set ns = namespace(primaryFields=[]) %}{% for record in vars.fileData.records %}{% for key,value in record.items() %}{% if value is iterable and value is not string and (value['@id'] or (value[0] and value[0]['@id'])) %}{% set _dummy = ns.primaryFields.append(key) %}{% endif %}{% endfor %}{% for field in ns.primaryFields %}{% if field in record %}{% set _dummy = record.pop(field) %}{% endif %}{% endfor %}{% endfor %}{{ vars.fileData.records }}",
                "recordsWithRelationships": "{% set ns = namespace(primaryFields=[]) %}{% for record in vars.fileDataCopy.records %}{% set iri = '/api/3/' + vars.fileDataCopy.type + '/' + record.uuid %}{% for key,value in record.items() %}{% if value is not iterable or value is string or not (value['@id'] or (value[0] and value[0]['@id'])) %}{% set _dummy = ns.primaryFields.append(key) %}{% endif %}{% endfor %}{% for field in ns.primaryFields %}{% if field in record %}{% set _dummy = record.pop(field) %}{% endif %}{% set _dummy = record.update({'@id': iri}) %}{% endfor %}{% endfor %}{{ vars.fileDataCopy.records }}"
              },
              "status": null,
              "top": "300",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "43930233-ebc4-467a-a11e-20787df119bd",
              "id": 5097
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Download file",
              "targetStep": "/api/3/workflow_steps/d5dbfb67-afd8-4988-8456-9fad98de0d69",
              "sourceStep": "/api/3/workflow_steps/5d22caeb-2354-4b93-bf8b-e3d8694fc1fe",
              "label": null,
              "isExecuted": false,
              "uuid": "c1dfc925-04d6-4b9a-8c02-6df9706ca45b"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Download file -> Split by lists",
              "targetStep": "/api/3/workflow_steps/43930233-ebc4-467a-a11e-20787df119bd",
              "sourceStep": "/api/3/workflow_steps/d5dbfb67-afd8-4988-8456-9fad98de0d69",
              "label": null,
              "isExecuted": false,
              "uuid": "51cc198a-eb7c-4da7-b617-53f6f0c8c529"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Split by lists -> Import via Bulk API",
              "targetStep": "/api/3/workflow_steps/f8559c3d-2db0-49ae-8af1-a93665020aaa",
              "sourceStep": "/api/3/workflow_steps/43930233-ebc4-467a-a11e-20787df119bd",
              "label": null,
              "isExecuted": false,
              "uuid": "ac12cc89-f1bf-4158-ab50-1aa7014ab9fe"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Import primary fields via Bulk API -> Copy  of Import primary fields via Bulk API",
              "targetStep": "/api/3/workflow_steps/24bac88e-b1b5-4dfd-9098-c13be14c1db7",
              "sourceStep": "/api/3/workflow_steps/f8559c3d-2db0-49ae-8af1-a93665020aaa",
              "label": null,
              "isExecuted": false,
              "uuid": "8d507f1f-c9a6-4c85-83d6-6ad845d34efe"
            }
          ],
          "priority": null,
          "uuid": "a9e6d165-ecc9-4e51-a262-9c451fd38184",
          "recordTags": [
            "ManualTrigger"
          ],
          "id": 1182,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1626860823,
          "modifyUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "modifyDate": 1626860823,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Pre-req check",
          "aliasName": null,
          "tag": null,
          "description": "Checks if required configurations are set , if not will prompt to set",
          "isActive": true,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "recordIRI",
            "recordName"
          ],
          "synchronous": false,
          "lastModifyDate": 1626867862,
          "collection": "/api/3/workflow_collections/86c5ea16-d69d-46e1-8013-2437beadbb09",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/8a28139e-8fdf-4788-85f6-3a34d2f407d5",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  }
                }
              },
              "status": null,
              "top": "30",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "uuid": "8a28139e-8fdf-4788-85f6-3a34d2f407d5",
              "id": 5098
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Record",
              "description": null,
              "arguments": {
                "message": {
                  "tags": [],
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "tenant": "",
                  "content": "Scenario Configuration Deployed",
                  "records": "{{vars.input.params.recordIRI}}"
                },
                "resource": [],
                "_showJson": false,
                "operation": "Append",
                "collection": "{{vars.input.params.recordIRI}}",
                "__recommend": [],
                "collectionType": "/api/3/scenario",
                "fieldOperation": {
                  "recordTags": "Append"
                },
                "step_variables": []
              },
              "status": null,
              "top": "700",
              "left": "480",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "b0ca5cb9-e8f2-4a18-bb8f-945cf9c75cb8",
              "id": 5099
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Draft Details",
              "description": null,
              "arguments": {
                "draft_job_list": "{{vars.result_data | json_query(\"[*].file\") | json_query(\"[? filename=='\"+vars.input.params.recordName+\"']\")}}"
              },
              "status": null,
              "top": "300",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "094f0560-ed91-472e-8566-a36d94de7809",
              "id": 5100
            },
            {
              "@type": "WorkflowStep",
              "name": "Check Import Jobs",
              "description": null,
              "arguments": {
                "params": {
                  "iri": "/api/query/import_jobs",
                  "body": "{\n    \"sort\": [\n        {\n            \"field\": \"modifyDate\",\n            \"direction\": \"DESC\"\n        }\n    ],\n    \"logic\": \"AND\",\n    \"filters\": [],\n    \"__selectFields\": [\n        \"file\",\n        \"status\"\n    ]\n}",
                  "method": "POST"
                },
                "version": "3.1.1",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "FSR: Make FortiSOAR API Call",
                "step_variables": {
                  "result_data": "{{vars.result.data['hydra:member'] | json_query(\"[?status==\\'Draft\\']\")}}"
                }
              },
              "status": null,
              "top": "165",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "68e966d0-b33c-4483-806c-21333388c8a9",
              "id": 5101
            },
            {
              "@type": "WorkflowStep",
              "name": "Is Import needed",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Yes",
                    "step_iri": "/api/3/workflow_steps/002f2893-8bed-42af-a6cf-49effaacd53d",
                    "condition": "{{ vars.draft_job_list | length != 0 }}",
                    "step_name": "Prompt User"
                  },
                  {
                    "option": "No",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/6803e82a-fac3-4a81-81ee-6cea242325f9",
                    "step_name": "Do Nothing"
                  }
                ]
              },
              "status": null,
              "top": "435",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "0083da1a-2007-4c23-a217-4dc87b499256",
              "id": 5102
            },
            {
              "@type": "WorkflowStep",
              "name": "Do Nothing",
              "description": null,
              "arguments": {
                "params": [],
                "version": "3.1.1",
                "connector": "cyops_utilities",
                "operation": "no_op",
                "operationTitle": "Utils: No Operation",
                "step_variables": []
              },
              "status": null,
              "top": "570",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "6803e82a-fac3-4a81-81ee-6cea242325f9",
              "id": 5103
            },
            {
              "@type": "WorkflowStep",
              "name": "Prompt User",
              "description": null,
              "arguments": {
                "type": "DecisionBased",
                "input": {
                  "schema": {
                    "title": "Did you deploy configuration",
                    "description": "Please confirm that you have deployed the **{{vars.input.params.recordName}}** configuration.\n\nIf not, please close this window, and navigate to Import Wizard and import the  '**{{vars.input.params.recordName}}**' template.\n\nThen come back to the Manual Input and click **yes** to proceed.",
                    "inputVariables": []
					
                  }
                },
                "record": "{{vars.input.params.recordIRI}}",
                "resources": "scenario",
                "owner_detail": {
                  "isAssigned": false
                },
                "step_variables": [],
                "response_mapping": {
                  "options": [
                    {
                      "option": "Yes",
                      "primary": true,
                      "step_iri": "/api/3/workflow_steps/b0ca5cb9-e8f2-4a18-bb8f-945cf9c75cb8"
                    }
                  ],
                  "duplicateOption": false
                },
                "email_notification": {
                  "enabled": false,
                  "smtpParameters": []
                }
              },
              "status": null,
              "top": "570",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/fc04082a-d7dc-4299-96fb-6837b1baa0fe",
              "uuid": "002f2893-8bed-42af-a6cf-49effaacd53d",
              "id": 5104
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Check If Configuration is deployed -> Update Record",
              "targetStep": "/api/3/workflow_steps/b0ca5cb9-e8f2-4a18-bb8f-945cf9c75cb8",
              "sourceStep": "/api/3/workflow_steps/002f2893-8bed-42af-a6cf-49effaacd53d",
              "label": "Yes",
              "isExecuted": false,
              "uuid": "7b05686f-b7d0-4a09-9650-436dae95bcb3"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Check Import Jobs -> Get Draft Details",
              "targetStep": "/api/3/workflow_steps/094f0560-ed91-472e-8566-a36d94de7809",
              "sourceStep": "/api/3/workflow_steps/68e966d0-b33c-4483-806c-21333388c8a9",
              "label": null,
              "isExecuted": false,
              "uuid": "23d31b4f-4daf-485b-a045-338452e9d876"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Check Import Jobs",
              "targetStep": "/api/3/workflow_steps/68e966d0-b33c-4483-806c-21333388c8a9",
              "sourceStep": "/api/3/workflow_steps/8a28139e-8fdf-4788-85f6-3a34d2f407d5",
              "label": null,
              "isExecuted": false,
              "uuid": "15110778-6238-493f-bf9a-5ec7ff8edc87"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Draft Details -> Is Import needed",
              "targetStep": "/api/3/workflow_steps/0083da1a-2007-4c23-a217-4dc87b499256",
              "sourceStep": "/api/3/workflow_steps/094f0560-ed91-472e-8566-a36d94de7809",
              "label": null,
              "isExecuted": false,
              "uuid": "edc3dbb7-4b05-4195-a9b0-a71600d21f83"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is Import needed -> Do Nothing",
              "targetStep": "/api/3/workflow_steps/6803e82a-fac3-4a81-81ee-6cea242325f9",
              "sourceStep": "/api/3/workflow_steps/0083da1a-2007-4c23-a217-4dc87b499256",
              "label": "No",
              "isExecuted": false,
              "uuid": "f2f629ec-8a01-4eaa-8e16-50219326b7c1"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is Import needed -> Check If Configuration is deployed",
              "targetStep": "/api/3/workflow_steps/002f2893-8bed-42af-a6cf-49effaacd53d",
              "sourceStep": "/api/3/workflow_steps/0083da1a-2007-4c23-a217-4dc87b499256",
              "label": "Yes",
              "isExecuted": false,
              "uuid": "0ed455e7-b5cf-44fd-ba8e-af67f95bff66"
            }
          ],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "bac46748-666a-4374-a780-92539f0efc98",
          "recordTags": [],
          "id": 1183,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1626860823,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1626867862,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Export Selected Scenario",
          "aliasName": null,
          "tag": null,
          "description": "Export all selected scenario to a JSON file. This file is created as attachment record",
          "isActive": true,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1625655949,
          "collection": "/api/3/workflow_collections/86c5ea16-d69d-46e1-8013-2437beadbb09",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/34562beb-6b99-4b73-aa42-6acd4994859b",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Set recordType",
              "description": null,
              "arguments": {
                "recordType": "{{ vars.input.records[0]['@id'].split('/')[3] }}"
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "617b96b6-9b59-4931-af38-63df7f19c32e",
              "id": 5105
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "5972337a-16d2-4bea-8a09-5615bba70221",
                "title": "Export Scenario",
                "resources": [
                  "scenario"
                ],
                "inputVariables": [
                  {
                    "name": "fileName",
                    "type": "string",
                    "label": "File Name",
                    "tooltip": "",
                    "dataType": "text",
                    "formType": "text",
                    "required": true,
                    "_expanded": true,
                    "defaultValue": "Export",
                    "useRecordFieldDefault": false
                  }
                ],
                "step_variables": {
                  "input": {
                    "params": {
                      "fileName": "{{vars.request.data[\"fileName\"]}}"
                    },
                    "records": "{{vars.input.records}}"
                  }
                },
                "_promptexpanded": true,
                "displayConditions": {
                  "files": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  },
                  "alerts": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  },
                  "assets": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  },
                  "events": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  },
                  "usecase": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  },
                  "scenario": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  },
                  "incidents": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  },
                  "indicators": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "34562beb-6b99-4b73-aa42-6acd4994859b",
              "id": 5106
            },
            {
              "@type": "WorkflowStep",
              "name": "Create file",
              "description": null,
              "arguments": {
                "params": {
                  "contents": "{{ {'records': vars.steps.Export_selected_items.data['hydra:member'], 'type': vars.recordType} | toJSON }}",
                  "filename": "{{vars.input.params.fileName}}.json"
                },
                "version": "2.7.0",
                "connector": "cyops_utilities",
                "operation": "create_file_from_string",
                "operationTitle": "File: Create File from String",
                "step_variables": []
              },
              "status": null,
              "top": "435",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "1427ecbe-5c47-4931-a3e9-c73ed8f781e3",
              "id": 5107
            },
            {
              "@type": "WorkflowStep",
              "name": "Create attachment from file",
              "description": null,
              "arguments": {
                "params": {
                  "name": "{{vars.steps.Create_file.data.filename}}",
                  "filename": "{{vars.steps.Create_file.data.filename}}",
                  "description": "",
                  "request_headers": "",
                  "multipart_headers": "",
                  "extra_multipart_fields": ""
                },
                "version": "2.3.1",
                "connector": "cyops_utilities",
                "operation": "create_cyops_attachment",
                "operationTitle": "File: Create CyOPs Attachment from File",
                "step_variables": []
              },
              "status": null,
              "top": "570",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "3f164afd-eb64-4c68-a9c7-4e61b43f40d3",
              "id": 5108
            },
            {
              "@type": "WorkflowStep",
              "name": "Export selected items",
              "description": null,
              "arguments": {
                "params": {
                  "iri": "/api/query/{{vars.recordType}}?$export=true&$relationships=true",
                  "body": "{\"filters\": [{\"field\": \"uuid\", \"operator\": \"in\", \"value\": \"{{vars.input.records | json_query('[].\"@id\"') | map('replace', '/api/3/' + vars.recordType + '/', '') | join('|') }}\"}], \"logic\": \"AND\"}",
                  "method": "POST"
                },
                "version": "2.7.0",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "CyOPs: Make CyOPs API Call",
                "step_variables": []
              },
              "status": null,
              "top": "300",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "885adbf6-1acc-4c28-90c2-4f96e0d470ce",
              "id": 5109
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Export selected items -> Create attachment",
              "targetStep": "/api/3/workflow_steps/1427ecbe-5c47-4931-a3e9-c73ed8f781e3",
              "sourceStep": "/api/3/workflow_steps/885adbf6-1acc-4c28-90c2-4f96e0d470ce",
              "label": null,
              "isExecuted": false,
              "uuid": "9889aa94-ff5b-42a5-813b-c9b03fde390a"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Set type",
              "targetStep": "/api/3/workflow_steps/617b96b6-9b59-4931-af38-63df7f19c32e",
              "sourceStep": "/api/3/workflow_steps/34562beb-6b99-4b73-aa42-6acd4994859b",
              "label": null,
              "isExecuted": false,
              "uuid": "ee17794d-c90b-4ca2-9fc9-7b7ff7c5e826"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set recordType -> Export selected items",
              "targetStep": "/api/3/workflow_steps/885adbf6-1acc-4c28-90c2-4f96e0d470ce",
              "sourceStep": "/api/3/workflow_steps/617b96b6-9b59-4931-af38-63df7f19c32e",
              "label": null,
              "isExecuted": false,
              "uuid": "4576587b-5a71-4cf0-a95a-38fe8a781e4b"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create attachment -> Create attachment from file",
              "targetStep": "/api/3/workflow_steps/3f164afd-eb64-4c68-a9c7-4e61b43f40d3",
              "sourceStep": "/api/3/workflow_steps/1427ecbe-5c47-4931-a3e9-c73ed8f781e3",
              "label": null,
              "isExecuted": false,
              "uuid": "d1439a5d-ce94-4271-be07-fbf38144c8c2"
            }
          ],
          "priority": null,
          "uuid": "bf1d3de1-9b41-4649-85c2-dccbaf73a04a",
          "recordTags": [
            "ManualTrigger"
          ],
          "id": 1184,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1626860823,
          "modifyUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "modifyDate": 1626860823,
          "owners": [],
          "isPrivate": false
        }
      ]
    }
  ],
  "exported_tags": [
    "ManualTrigger"
  ]
}